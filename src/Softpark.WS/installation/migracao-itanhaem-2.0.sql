/*
Deployment script for Onlinecidade4

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
/*
The column [api].[CadastroDomiciliar].[idAuto] is being dropped, data loss could occur.

The column [api].[CadastroDomiciliar].[Justificativa] is being dropped, data loss could occur.
*/

IF EXISTS (select top 1 1 from [api].[CadastroDomiciliar])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
/*
The column [api].[CadastroIndividual].[idAuto] is being dropped, data loss could occur.

The column [api].[CadastroIndividual].[Justificativa] is being dropped, data loss could occur.
*/

IF EXISTS (select top 1 1 from [api].[CadastroIndividual])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
/*
The column [dbo].[ASSMED_Cadastro].[idAuto] is being dropped, data loss could occur.
*/

IF EXISTS (select top 1 1 from [dbo].[ASSMED_Cadastro])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
/*
The column [dbo].[ASSMED_Endereco].[ENDAREA] is being dropped, data loss could occur.

The column [dbo].[ASSMED_Endereco].[ENDAREAMICRO] is being dropped, data loss could occur.

The column [dbo].[ASSMED_Endereco].[ENDREFERENCIA] is being dropped, data loss could occur.

The column [dbo].[ASSMED_Endereco].[ENDSEMAREA] is being dropped, data loss could occur.

The column [dbo].[ASSMED_Endereco].[SEMNUMERO] is being dropped, data loss could occur.
*/

IF EXISTS (select top 1 1 from [dbo].[ASSMED_Endereco])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
PRINT N'Dropping [dbo].[DF_SIGSM_Avaliacao_Elegibilidade_Admissao_Paciente_nacionalidade]...';


GO
ALTER TABLE [dbo].[SIGSM_Avaliacao_Elegibilidade_Admissao_Paciente] DROP CONSTRAINT [DF_SIGSM_Avaliacao_Elegibilidade_Admissao_Paciente_nacionalidade];


GO
PRINT N'Removing schema binding from [api].[VW_Profissional]...';


GO
ALTER VIEW [api].[VW_Profissional]
AS
SELECT   ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS [id],
         RTRIM(LTRIM(doc.Numero)) COLLATE Latin1_General_CI_AI AS [CNS],
         RTRIM(LTRIM(cad.Nome)) COLLATE Latin1_General_CI_AI AS [Nome],
         RTRIM(LTRIM(cbo.CodProfTab)) COLLATE Latin1_General_CI_AI AS [CBO],
         RTRIM(LTRIM(cbo.DesProfTab)) COLLATE Latin1_General_CI_AI AS [Profissao],
         RTRIM(LTRIM(vinc.CNESLocal)) COLLATE Latin1_General_CI_AI AS [CNES],
         RTRIM(LTRIM(setor.DesSetor)) COLLATE Latin1_General_CI_AI AS [Unidade],
         RTRIM(LTRIM(ine.Numero)) COLLATE Latin1_General_CI_AI AS [INE],
         RTRIM(LTRIM(ine.Descricao)) COLLATE Latin1_General_CI_AI AS [Equipe],
         CAST (cad.Codigo AS INT) AS [CodUsu]
FROM     [dbo].[ASSMED_Cadastro] AS cad
         INNER JOIN
         [dbo].[ASSMED_CadastroDocPessoal] AS doc
         ON cad.Codigo = doc.Codigo
         INNER JOIN
         [dbo].[AS_CREDENCIADOS] AS cred
         ON cad.Codigo = cred.Codigo
         INNER JOIN
         [dbo].[AS_CredenciadosVinc] AS vinc
         ON cred.CodCred = vinc.CodCred
         INNER JOIN
         [dbo].[AS_ProfissoesTab] AS cbo
         ON RTRIM(LTRIM(vinc.CodProfTab)) COLLATE Latin1_General_CI_AI = RTRIM(LTRIM(cbo.CodProfTab)) COLLATE Latin1_General_CI_AI
         INNER JOIN
         [dbo].[AS_SetoresPar] AS par
         ON RTRIM(LTRIM(vinc.CNESLocal)) COLLATE Latin1_General_CI_AI = RTRIM(LTRIM(par.CNES)) COLLATE Latin1_General_CI_AI
         INNER JOIN
         [dbo].[Setores] AS setor
         ON par.CodSetor = setor.CodSetor
            AND par.Codigo = setor.Codigo
         LEFT OUTER JOIN
         [dbo].[SetoresINEs] AS ine
         ON setor.CodSetor = ine.CodSetor
            AND RTRIM(LTRIM(vinc.CodINE)) COLLATE Latin1_General_CI_AI = RTRIM(LTRIM(ine.CodINE)) COLLATE Latin1_General_CI_AI
WHERE    doc.CodTpDocP = 6
         AND cbo.CodProfissao IS NOT NULL
         AND LEN(LTRIM(RTRIM(COALESCE (doc.Numero COLLATE Latin1_General_CI_AI, '')))) > 0
         AND LEN(LTRIM(RTRIM(COALESCE (vinc.CNESLocal COLLATE Latin1_General_CI_AI, '')))) > 0
GROUP BY RTRIM(LTRIM(doc.Numero)) COLLATE Latin1_General_CI_AI, RTRIM(LTRIM(cad.Nome)) COLLATE Latin1_General_CI_AI, RTRIM(LTRIM(cbo.CodProfTab)) COLLATE Latin1_General_CI_AI, RTRIM(LTRIM(cbo.DesProfTab)) COLLATE Latin1_General_CI_AI, RTRIM(LTRIM(vinc.CNESLocal)) COLLATE Latin1_General_CI_AI, RTRIM(LTRIM(setor.DesSetor)) COLLATE Latin1_General_CI_AI, RTRIM(LTRIM(ine.Numero)) COLLATE Latin1_General_CI_AI, RTRIM(LTRIM(ine.Descricao)) COLLATE Latin1_General_CI_AI, cad.Codigo;


GO
PRINT N'Altering [api].[CadastroDomiciliar]...';


GO
ALTER TABLE [api].[CadastroDomiciliar] DROP COLUMN [idAuto], COLUMN [Justificativa];


GO
PRINT N'Altering [api].[CadastroIndividual]...';


GO
ALTER TABLE [api].[CadastroIndividual] DROP COLUMN [idAuto], COLUMN [Justificativa];


GO
PRINT N'Altering [api].[FichaVisitaDomiciliarChild]...';


GO
ALTER TABLE [api].[FichaVisitaDomiciliarChild]
    ADD [nomeCidadao] VARCHAR (80) NULL,
        [Codigo]      DECIMAL (18) NULL;


GO
PRINT N'Altering [dbo].[ASSMED_Cadastro]...';


GO
ALTER TABLE [dbo].[ASSMED_Cadastro] DROP COLUMN [idAuto];



GO
PRINT N'Altering [dbo].[ASSMED_Endereco]...';


/* Obrigatório a sequencia abaixo até o próximo comentário */

GO
ALTER TABLE [dbo].[ASSMED_Endereco]
    ADD [MicroArea] CHAR (2) NULL;

	
GO
ALTER TABLE [dbo].[ASSMED_Cadastro]
    ADD [MicroArea] CHAR (2) NULL;


GO
INSERT INTO SIGSM_MicroAreas
select distinct (CASE LEN(RTRIM(LTRIM(microarea))) WHEN 1 THEN '0' + RTRIM(LTRIM(microarea)) ELSE RTRIM(LTRIM(microarea)) END),
'Micro Área ' + (CASE LEN(RTRIM(LTRIM(microarea))) WHEN 1 THEN '0' + RTRIM(LTRIM(microarea)) ELSE RTRIM(LTRIM(microarea)) END)
from api.enderecoLocalPermanencia p
where stForaArea = 0
group by (CASE LEN(RTRIM(LTRIM(microarea))) WHEN 1 THEN '0' + RTRIM(LTRIM(microarea)) ELSE RTRIM(LTRIM(microarea)) END)
order by 1



GO
INSERT INTO SIGSM_MicroAreas
select distinct (CASE LEN(RTRIM(LTRIM(microarea))) WHEN 1 THEN '0' + RTRIM(LTRIM(microarea)) ELSE RTRIM(LTRIM(microarea)) END),
'Micro Área ' + (CASE LEN(RTRIM(LTRIM(microarea))) WHEN 1 THEN '0' + RTRIM(LTRIM(microarea)) ELSE RTRIM(LTRIM(microarea)) END)
from api.IdentificacaoUsuarioCidadao
left join SIGSM_MicroAreas ma on (CASE LEN(RTRIM(LTRIM(microarea))) WHEN 1 THEN '0' + RTRIM(LTRIM(microarea)) ELSE RTRIM(LTRIM(microarea)) END) =
ma.Codigo
where stForaArea = 0 and ma.Codigo is null
group by (CASE LEN(RTRIM(LTRIM(microarea))) WHEN 1 THEN '0' + RTRIM(LTRIM(microarea)) ELSE RTRIM(LTRIM(microarea)) END)
order by 1



GO
INSERT INTO SIGSM_MicroAreas
select distinct (CASE LEN(RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA)))) WHEN 1 THEN '0' + RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA))) ELSE RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA))) END),
'Micro Área ' + (CASE LEN(RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA)))) WHEN 1 THEN '0' + RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA))) ELSE RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA))) END)
from ASSMED_Endereco e
left join SIGSM_MicroAreas ma on (CASE LEN(RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA)))) WHEN 1 THEN '0' + RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA))) ELSE RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA))) END) =
ma.Codigo
where ISNULL(e.ENDSEMAREA, (CASE WHEN COALESCE(e.ENDAREAMICRO, e.ENDAREA) IS NULL THEN 1 ELSE 0 END)) = 0 and ma.Codigo is null
and LEN(RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA)))) BETWEEN 1 AND 2
group by (CASE LEN(RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA)))) WHEN 1 THEN '0' + RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA))) ELSE RTRIM(LTRIM(COALESCE(e.ENDAREAMICRO, e.ENDAREA))) END)
order by 1




GO
UPDATE ASSMED_Cadastro SET MicroArea =
	(CASE LEN(RTRIM(LTRIM(i.microarea))) WHEN 1 THEN '0' + RTRIM(LTRIM(i.microarea)) ELSE RTRIM(LTRIM(i.microarea)) END)
	   FROM ASSMED_Cadastro c
 INNER JOIN api.IdentificacaoUsuarioCidadao i
		 ON c.IdFicha = i.id
	  WHERE i.stForaArea = 0 AND c.MicroArea IS NULL



GO
UPDATE ASSMED_Endereco SET MicroArea =
	(CASE LEN(RTRIM(LTRIM(i.microarea))) WHEN 1 THEN '0' + RTRIM(LTRIM(i.microarea)) ELSE RTRIM(LTRIM(i.microarea)) END)
	   FROM ASSMED_Endereco c
 INNER JOIN api.EnderecoLocalPermanencia i
		 ON c.IdFicha = i.id
	  WHERE i.stForaArea = 0 AND c.MicroArea IS NULL



GO
ALTER TABLE [dbo].[ASSMED_Endereco] DROP COLUMN [ENDAREA], COLUMN [ENDAREAMICRO], COLUMN [ENDREFERENCIA], COLUMN [ENDSEMAREA], COLUMN [SEMNUMERO];

GO
PRINT N'Altering [dbo].[SIGSM_Avaliacao_Elegibilidade_Admissao_Paciente]...';


GO
ALTER TABLE [dbo].[SIGSM_Avaliacao_Elegibilidade_Admissao_Paciente] ALTER COLUMN [nacionalidade] INT NULL;


GO
PRINT N'Altering [dbo].[SIGSM_Domiciliar_Procedimentos]...';


GO
ALTER TABLE [dbo].[SIGSM_Domiciliar_Procedimentos]
    ADD [sigtap] CHAR (10) NULL;


CREATE TABLE #MrDataConverter (
  sigtap VARCHAR(10),
  descricao VARCHAR(255)
)
GO

INSERT INTO #MrDataConverter 
VALUES 
  ('0301070024','Acompanhamento de paciente em reabilitação em comunicação alternativa'),
  ('0301050082','Antibioticoterapia parenteral'),
  ('0301070075','Atendimento / Acompanhamento de paciente em reabilitação do desenvolvimento neuropsicomotor'),
  ('0302040021','Atendimento fisioterapêutico em paciente com transtorno respiratório sem complicações sistêmicas'),
  ('0301050090','Atendimento médico com finalidade de atestar óbito'),
  ('0301070067','Atendimento / Acompanhamento em reabilitação nas múltiplas deficiências'),
  ('0301100047','Cateterismo vesical de alívio'),
  ('0301100055','Cateterismo vesical de demora'),
  ('0201020041','Coleta de material para exame laboratorial'),
  ('0301100063','Cuidados com estomas'),
  ('0301100071','Cuidados com traqueostomia'),
  ('0301100098','Enema'),
  ('0301100144','Oxigenoterapia'),
  ('0301100152','Retirada de pontos de cirurgias básicas (por paciente)'),
  ('0301100179','Sondagem gástrica'),
  ('0301100187','Terapia de reidratação oral'),
  ('0301050120','Terapia de reidratação parenteral'),
  ('0301070113','Terapia fonoaudiológica individual'),
  ('0308010019','Tratamento de traumatismos de localização especificada / não especificada'),
  ('0303190019','Tratamento em reabilitação');
GO

update SIGSM_Domiciliar_Procedimentos set sigtap = mdc.sigtap
from SIGSM_Domiciliar_Procedimentos dcp
left join #MrDataConverter mdc on dcp.descricao COLLATE Latin1_General_CI_AI = mdc.descricao
GO

DROP TABLE #MrDataConverter;

update SIGSM_Domiciliar_Procedimentos set sigtap = '0301070075'
WHERE id_procedimentos = 3

update SIGSM_Domiciliar_Procedimentos set sigtap = '0302040021'
WHERE id_procedimentos = 4

update SIGSM_Domiciliar_Procedimentos set sigtap = '0301070067'
WHERE id_procedimentos = 6

update SIGSM_Domiciliar_Procedimentos set sigtap = '0301100152'
WHERE id_procedimentos = 14

update SIGSM_Domiciliar_Procedimentos set sigtap = '0308010019'
WHERE id_procedimentos = 19

DELETE FROM SIGSM_Domiciliar_Procedimentos WHERE id_procedimentos = 21
GO

GO
PRINT N'Altering [dbo].[SIGSM_ServicoSerializador_Agenda]...';


/* FIM */


GO
ALTER TABLE [dbo].[SIGSM_ServicoSerializador_Agenda]
    ADD [LogMessage] TEXT NULL;


GO
PRINT N'Altering [dbo].[SIGSM_Transmissao_Processos]...';


GO
ALTER TABLE [dbo].[SIGSM_Transmissao_Processos]
    ADD [CNES] CHAR (7) DEFAULT ('       ') NOT NULL;


GO
PRINT N'Creating [api].[Documentos]...';


GO
CREATE TABLE [api].[Documentos] (
    [Id]                            UNIQUEIDENTIFIER NOT NULL,
    [IdIdentificacaoUsuarioCidadao] UNIQUEIDENTIFIER NOT NULL,
    [NumContrato]                   INT              NOT NULL,
    [IdTipoDocumento]               INT              NOT NULL,
    [TipoArquivo]                   VARCHAR (60)     NOT NULL,
    [Tamanho]                       BIGINT           NOT NULL,
    [Data]                          DATETIME         NOT NULL,
    [Arquivo]                       VARBINARY (MAX)  NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating [dbo].[SIGSM_FichaProfissao]...';


GO
CREATE TABLE [dbo].[SIGSM_FichaProfissao] (
    [Id]    INT           IDENTITY (1, 1) NOT NULL,
    [Ficha] NVARCHAR (32) NOT NULL,
    [CBO]   CHAR (6)      NOT NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);

SET IDENTITY_INSERT [dbo].[SIGSM_FichaProfissao] ON 
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (1, N'CadastroIndividual', N'322205')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (2, N'CadastroIndividual', N'322210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (3, N'CadastroIndividual', N'322230')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (4, N'CadastroIndividual', N'322245')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (5, N'CadastroIndividual', N'322250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (6, N'CadastroIndividual', N'322405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (7, N'CadastroIndividual', N'322415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (8, N'CadastroIndividual', N'322425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (9, N'CadastroIndividual', N'322430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (10, N'CadastroIndividual', N'352210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (11, N'CadastroIndividual', N'515105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (12, N'CadastroIndividual', N'515120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (13, N'CadastroIndividual', N'515124')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (14, N'CadastroIndividual', N'515130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (15, N'CadastroIndividual', N'515140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (16, N'CadastroIndividual', N'515305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (17, N'CadastroIndividual', N'515310')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (18, N'CadastroIndividual', N'422110')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (19, N'CadastroDomiciliar', N'322205')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (20, N'CadastroDomiciliar', N'322210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (21, N'CadastroDomiciliar', N'322229')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (22, N'CadastroDomiciliar', N'322244')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (23, N'CadastroDomiciliar', N'322250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (24, N'CadastroDomiciliar', N'322405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (25, N'CadastroDomiciliar', N'322415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (26, N'CadastroDomiciliar', N'322425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (27, N'CadastroDomiciliar', N'322430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (28, N'CadastroDomiciliar', N'352210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (29, N'CadastroDomiciliar', N'515105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (30, N'CadastroDomiciliar', N'515120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (31, N'CadastroDomiciliar', N'515125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (32, N'CadastroDomiciliar', N'515130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (33, N'CadastroDomiciliar', N'515140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (34, N'CadastroDomiciliar', N'515305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (35, N'CadastroDomiciliar', N'515310')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (36, N'CadastroDomiciliar', N'422110')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (37, N'AtendimentoIndividual', N'251605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (38, N'AtendimentoIndividual', N'515305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (39, N'AtendimentoIndividual', N'223505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (40, N'AtendimentoIndividual', N'223565')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (41, N'AtendimentoIndividual', N'223530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (42, N'AtendimentoIndividual', N'223545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (43, N'AtendimentoIndividual', N'223550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (44, N'AtendimentoIndividual', N'223555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (45, N'AtendimentoIndividual', N'223560')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (46, N'AtendimentoIndividual', N'223405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (47, N'AtendimentoIndividual', N'223415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (48, N'AtendimentoIndividual', N'223430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (49, N'AtendimentoIndividual', N'223444')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (50, N'AtendimentoIndividual', N'223425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (51, N'AtendimentoIndividual', N'223650')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (52, N'AtendimentoIndividual', N'223605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (53, N'AtendimentoIndividual', N'223810')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (54, N'AtendimentoIndividual', N'225105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (55, N'AtendimentoIndividual', N'225110')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (56, N'AtendimentoIndividual', N'225119')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (57, N'AtendimentoIndividual', N'225125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (58, N'AtendimentoIndividual', N'225142')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (59, N'AtendimentoIndividual', N'225130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (60, N'AtendimentoIndividual', N'225135')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (61, N'AtendimentoIndividual', N'225140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (62, N'AtendimentoIndividual', N'225155')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (63, N'AtendimentoIndividual', N'225160')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (64, N'AtendimentoIndividual', N'225165')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (65, N'AtendimentoIndividual', N'225170')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (66, N'AtendimentoIndividual', N'225180')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (67, N'AtendimentoIndividual', N'225250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (68, N'AtendimentoIndividual', N'225185')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (69, N'AtendimentoIndividual', N'225195')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (70, N'AtendimentoIndividual', N'225103')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (71, N'AtendimentoIndividual', N'225255')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (72, N'AtendimentoIndividual', N'225109')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (73, N'AtendimentoIndividual', N'225350')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (74, N'AtendimentoIndividual', N'225112')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (75, N'AtendimentoIndividual', N'225118')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (76, N'AtendimentoIndividual', N'225265')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (77, N'AtendimentoIndividual', N'225121')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (78, N'AtendimentoIndividual', N'225270')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (79, N'AtendimentoIndividual', N'225275')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (80, N'AtendimentoIndividual', N'225124')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (81, N'AtendimentoIndividual', N'225127')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (82, N'AtendimentoIndividual', N'225133')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (83, N'AtendimentoIndividual', N'2231F9')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (84, N'AtendimentoIndividual', N'225136')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (85, N'AtendimentoIndividual', N'225139')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (86, N'AtendimentoIndividual', N'225154')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (87, N'AtendimentoIndividual', N'225285')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (88, N'AtendimentoIndividual', N'226305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (89, N'AtendimentoIndividual', N'251545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (90, N'AtendimentoIndividual', N'223710')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (91, N'AtendimentoIndividual', N'239415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (92, N'AtendimentoIndividual', N'234410')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (93, N'AtendimentoIndividual', N'2241E1')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (94, N'AtendimentoIndividual', N'251550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (95, N'AtendimentoIndividual', N'251555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (96, N'AtendimentoIndividual', N'251510')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (97, N'AtendimentoIndividual', N'251540')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (98, N'AtendimentoIndividual', N'251505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (99, N'AtendimentoIndividual', N'251530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (100, N'AtendimentoIndividual', N'239425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (101, N'AtendimentoIndividual', N'223905')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (102, N'AtendimentoOdontologico', N'223204')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (103, N'AtendimentoOdontologico', N'223208')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (104, N'AtendimentoOdontologico', N'223280')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (105, N'AtendimentoOdontologico', N'223284')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (106, N'AtendimentoOdontologico', N'223212')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (107, N'AtendimentoOdontologico', N'223216')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (108, N'AtendimentoOdontologico', N'223220')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (109, N'AtendimentoOdontologico', N'223224')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (110, N'AtendimentoOdontologico', N'223228')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (111, N'AtendimentoOdontologico', N'223276')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (112, N'AtendimentoOdontologico', N'223288')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (113, N'AtendimentoOdontologico', N'223232')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (114, N'AtendimentoOdontologico', N'223236')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (115, N'AtendimentoOdontologico', N'223240')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (116, N'AtendimentoOdontologico', N'223244')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (117, N'AtendimentoOdontologico', N'223248')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (118, N'AtendimentoOdontologico', N'223252')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (119, N'AtendimentoOdontologico', N'223256')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (120, N'AtendimentoOdontologico', N'223260')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (121, N'AtendimentoOdontologico', N'223264')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (122, N'AtendimentoOdontologico', N'223268')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (123, N'AtendimentoOdontologico', N'223272')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (124, N'AtendimentoOdontologico', N'223293')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (125, N'AtendimentoOdontologico', N'322415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (126, N'AtendimentoOdontologico', N'322430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (127, N'AtendimentoOdontologico', N'322405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (128, N'AtendimentoOdontologico', N'322425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (129, N'AtividadeColetiva', N'251605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (130, N'AtividadeColetiva', N'515305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (131, N'AtividadeColetiva', N'223505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (132, N'AtividadeColetiva', N'223565')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (133, N'AtividadeColetiva', N'223530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (134, N'AtividadeColetiva', N'223545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (135, N'AtividadeColetiva', N'223550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (136, N'AtividadeColetiva', N'223555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (137, N'AtividadeColetiva', N'223560')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (138, N'AtividadeColetiva', N'223405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (139, N'AtividadeColetiva', N'223415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (140, N'AtividadeColetiva', N'223430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (141, N'AtividadeColetiva', N'223445')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (142, N'AtividadeColetiva', N'223425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (143, N'AtividadeColetiva', N'223650')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (144, N'AtividadeColetiva', N'223605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (145, N'AtividadeColetiva', N'223810')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (146, N'AtividadeColetiva', N'225105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (147, N'AtividadeColetiva', N'225110')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (148, N'AtividadeColetiva', N'225120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (149, N'AtividadeColetiva', N'225125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (150, N'AtividadeColetiva', N'225142')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (151, N'AtividadeColetiva', N'225130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (152, N'AtividadeColetiva', N'225135')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (153, N'AtividadeColetiva', N'225140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (154, N'AtividadeColetiva', N'225155')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (155, N'AtividadeColetiva', N'225160')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (156, N'AtividadeColetiva', N'225165')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (157, N'AtividadeColetiva', N'225170')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (158, N'AtividadeColetiva', N'225180')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (159, N'AtividadeColetiva', N'225250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (160, N'AtividadeColetiva', N'225185')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (161, N'AtividadeColetiva', N'225195')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (162, N'AtividadeColetiva', N'225103')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (163, N'AtividadeColetiva', N'225255')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (164, N'AtividadeColetiva', N'225109')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (165, N'AtividadeColetiva', N'225350')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (166, N'AtividadeColetiva', N'225112')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (167, N'AtividadeColetiva', N'225118')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (168, N'AtividadeColetiva', N'225265')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (169, N'AtividadeColetiva', N'225121')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (170, N'AtividadeColetiva', N'225270')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (171, N'AtividadeColetiva', N'225275')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (172, N'AtividadeColetiva', N'225124')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (173, N'AtividadeColetiva', N'225127')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (174, N'AtividadeColetiva', N'225133')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (175, N'AtividadeColetiva', N'2231F9')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (176, N'AtividadeColetiva', N'225136')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (177, N'AtividadeColetiva', N'225139')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (178, N'AtividadeColetiva', N'225154')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (179, N'AtividadeColetiva', N'225285')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (180, N'AtividadeColetiva', N'226305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (181, N'AtividadeColetiva', N'251545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (182, N'AtividadeColetiva', N'223710')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (183, N'AtividadeColetiva', N'239415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (184, N'AtividadeColetiva', N'234410')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (185, N'AtividadeColetiva', N'2241E1')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (186, N'AtividadeColetiva', N'251550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (187, N'AtividadeColetiva', N'251555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (188, N'AtividadeColetiva', N'251510')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (189, N'AtividadeColetiva', N'251540')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (190, N'AtividadeColetiva', N'251505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (191, N'AtividadeColetiva', N'251530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (192, N'AtividadeColetiva', N'239425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (193, N'AtividadeColetiva', N'223905')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (194, N'AtividadeColetiva', N'223204')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (195, N'AtividadeColetiva', N'223208')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (196, N'AtividadeColetiva', N'223280')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (197, N'AtividadeColetiva', N'223284')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (198, N'AtividadeColetiva', N'223212')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (199, N'AtividadeColetiva', N'223216')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (200, N'AtividadeColetiva', N'223220')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (201, N'AtividadeColetiva', N'223224')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (202, N'AtividadeColetiva', N'223228')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (203, N'AtividadeColetiva', N'223276')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (204, N'AtividadeColetiva', N'223288')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (205, N'AtividadeColetiva', N'223232')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (206, N'AtividadeColetiva', N'223236')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (207, N'AtividadeColetiva', N'223240')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (208, N'AtividadeColetiva', N'223244')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (209, N'AtividadeColetiva', N'223248')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (210, N'AtividadeColetiva', N'223252')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (211, N'AtividadeColetiva', N'223256')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (212, N'AtividadeColetiva', N'223260')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (213, N'AtividadeColetiva', N'223264')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (214, N'AtividadeColetiva', N'223268')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (215, N'AtividadeColetiva', N'223272')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (216, N'AtividadeColetiva', N'223293')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (217, N'AtividadeColetiva', N'322415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (218, N'AtividadeColetiva', N'322430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (219, N'AtividadeColetiva', N'322405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (220, N'AtividadeColetiva', N'322425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (221, N'AtividadeColetiva', N'352210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (222, N'AtividadeColetiva', N'515105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (223, N'AtividadeColetiva', N'515140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (224, N'AtividadeColetiva', N'515130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (225, N'AtividadeColetiva', N'515125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (226, N'AtividadeColetiva', N'515120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (227, N'AtividadeColetiva', N'515310')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (228, N'AtividadeColetiva', N'322230')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (229, N'AtividadeColetiva', N'322250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (230, N'AtividadeColetiva', N'322205')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (231, N'AtividadeColetiva', N'322245')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (232, N'AtividadeColetiva', N'322210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (233, N'AtividadeColetiva', N'322405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (234, N'AtividadeColetiva', N'322425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (235, N'Procedimento', N'251605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (236, N'Procedimento', N'515305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (237, N'Procedimento', N'223505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (238, N'Procedimento', N'223565')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (239, N'Procedimento', N'223530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (240, N'Procedimento', N'223545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (241, N'Procedimento', N'223550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (242, N'Procedimento', N'223555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (243, N'Procedimento', N'223560')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (244, N'Procedimento', N'223405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (245, N'Procedimento', N'223415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (246, N'Procedimento', N'223430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (247, N'Procedimento', N'223445')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (248, N'Procedimento', N'223425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (249, N'Procedimento', N'223650')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (250, N'Procedimento', N'223605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (251, N'Procedimento', N'223810')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (252, N'Procedimento', N'225105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (253, N'Procedimento', N'225110')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (254, N'Procedimento', N'225120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (255, N'Procedimento', N'225125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (256, N'Procedimento', N'225142')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (257, N'Procedimento', N'225129')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (258, N'Procedimento', N'225135')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (259, N'Procedimento', N'225140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (260, N'Procedimento', N'225155')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (261, N'Procedimento', N'225160')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (262, N'Procedimento', N'225165')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (263, N'Procedimento', N'225169')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (264, N'Procedimento', N'225180')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (265, N'Procedimento', N'225250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (266, N'Procedimento', N'225185')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (267, N'Procedimento', N'225195')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (268, N'Procedimento', N'225103')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (269, N'Procedimento', N'225254')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (270, N'Procedimento', N'225109')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (271, N'Procedimento', N'225350')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (272, N'Procedimento', N'225112')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (273, N'Procedimento', N'225118')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (274, N'Procedimento', N'225264')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (275, N'Procedimento', N'225121')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (276, N'Procedimento', N'225270')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (277, N'Procedimento', N'225275')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (278, N'Procedimento', N'225124')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (279, N'Procedimento', N'225127')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (280, N'Procedimento', N'225132')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (281, N'Procedimento', N'2231F9')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (282, N'Procedimento', N'225136')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (283, N'Procedimento', N'225139')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (284, N'Procedimento', N'225154')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (285, N'Procedimento', N'225285')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (286, N'Procedimento', N'226305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (287, N'Procedimento', N'251545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (288, N'Procedimento', N'223710')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (289, N'Procedimento', N'239415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (290, N'Procedimento', N'234410')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (291, N'Procedimento', N'2241E1')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (292, N'Procedimento', N'251550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (293, N'Procedimento', N'251555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (294, N'Procedimento', N'251510')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (295, N'Procedimento', N'251540')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (296, N'Procedimento', N'251505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (297, N'Procedimento', N'251530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (298, N'Procedimento', N'239425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (299, N'Procedimento', N'223905')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (300, N'Procedimento', N'322230')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (301, N'Procedimento', N'322250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (302, N'Procedimento', N'322205')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (303, N'Procedimento', N'322245')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (304, N'Procedimento', N'322210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (305, N'Procedimento', N'322405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (306, N'Procedimento', N'322425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (307, N'Procedimento', N'515105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (308, N'Procedimento', N'515140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (309, N'Procedimento', N'515130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (310, N'Procedimento', N'515125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (311, N'Procedimento', N'515120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (312, N'Procedimento', N'515310')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (313, N'VisitaDomiciliar', N'515105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (314, N'VisitaDomiciliar', N'515120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (315, N'VisitaDomiciliar', N'515310')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (316, N'VisitaDomiciliar', N'515140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (317, N'ConsumoAlimentar', N'251605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (318, N'ConsumoAlimentar', N'515305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (319, N'ConsumoAlimentar', N'223505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (320, N'ConsumoAlimentar', N'223565')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (321, N'ConsumoAlimentar', N'223530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (322, N'ConsumoAlimentar', N'223545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (323, N'ConsumoAlimentar', N'223550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (324, N'ConsumoAlimentar', N'223555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (325, N'ConsumoAlimentar', N'223560')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (326, N'ConsumoAlimentar', N'223405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (327, N'ConsumoAlimentar', N'223415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (328, N'ConsumoAlimentar', N'223430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (329, N'ConsumoAlimentar', N'223445')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (330, N'ConsumoAlimentar', N'223425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (331, N'ConsumoAlimentar', N'223650')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (332, N'ConsumoAlimentar', N'223605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (333, N'ConsumoAlimentar', N'223810')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (334, N'ConsumoAlimentar', N'225105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (335, N'ConsumoAlimentar', N'225110')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (336, N'ConsumoAlimentar', N'225120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (337, N'ConsumoAlimentar', N'225125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (338, N'ConsumoAlimentar', N'225142')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (339, N'ConsumoAlimentar', N'225130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (340, N'ConsumoAlimentar', N'225135')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (341, N'ConsumoAlimentar', N'225140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (342, N'ConsumoAlimentar', N'225155')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (343, N'ConsumoAlimentar', N'225160')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (344, N'ConsumoAlimentar', N'225165')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (345, N'ConsumoAlimentar', N'225170')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (346, N'ConsumoAlimentar', N'225180')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (347, N'ConsumoAlimentar', N'225250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (348, N'ConsumoAlimentar', N'225185')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (349, N'ConsumoAlimentar', N'225195')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (350, N'ConsumoAlimentar', N'225103')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (351, N'ConsumoAlimentar', N'225255')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (352, N'ConsumoAlimentar', N'225109')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (353, N'ConsumoAlimentar', N'225350')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (354, N'ConsumoAlimentar', N'225112')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (355, N'ConsumoAlimentar', N'225118')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (356, N'ConsumoAlimentar', N'225265')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (357, N'ConsumoAlimentar', N'225121')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (358, N'ConsumoAlimentar', N'225270')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (359, N'ConsumoAlimentar', N'225275')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (360, N'ConsumoAlimentar', N'225124')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (361, N'ConsumoAlimentar', N'225127')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (362, N'ConsumoAlimentar', N'225133')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (363, N'ConsumoAlimentar', N'2231F9')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (364, N'ConsumoAlimentar', N'225136')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (365, N'ConsumoAlimentar', N'225139')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (366, N'ConsumoAlimentar', N'225154')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (367, N'ConsumoAlimentar', N'225285')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (368, N'ConsumoAlimentar', N'226305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (369, N'ConsumoAlimentar', N'251545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (370, N'ConsumoAlimentar', N'223710')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (371, N'ConsumoAlimentar', N'239414')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (372, N'ConsumoAlimentar', N'234410')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (373, N'ConsumoAlimentar', N'2241E1')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (374, N'ConsumoAlimentar', N'251550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (375, N'ConsumoAlimentar', N'251555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (376, N'ConsumoAlimentar', N'251510')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (377, N'ConsumoAlimentar', N'251540')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (378, N'ConsumoAlimentar', N'251504')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (379, N'ConsumoAlimentar', N'251530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (380, N'ConsumoAlimentar', N'239425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (381, N'ConsumoAlimentar', N'223905')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (382, N'ConsumoAlimentar', N'223204')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (383, N'ConsumoAlimentar', N'223208')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (384, N'ConsumoAlimentar', N'223280')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (385, N'ConsumoAlimentar', N'223284')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (386, N'ConsumoAlimentar', N'223212')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (387, N'ConsumoAlimentar', N'223216')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (388, N'ConsumoAlimentar', N'223220')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (389, N'ConsumoAlimentar', N'223224')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (390, N'ConsumoAlimentar', N'223228')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (391, N'ConsumoAlimentar', N'223276')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (392, N'ConsumoAlimentar', N'223288')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (393, N'ConsumoAlimentar', N'223232')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (394, N'ConsumoAlimentar', N'223236')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (395, N'ConsumoAlimentar', N'223240')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (396, N'ConsumoAlimentar', N'223244')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (397, N'ConsumoAlimentar', N'223248')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (398, N'ConsumoAlimentar', N'223252')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (399, N'ConsumoAlimentar', N'223256')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (400, N'ConsumoAlimentar', N'223260')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (401, N'ConsumoAlimentar', N'223264')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (402, N'ConsumoAlimentar', N'223268')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (403, N'ConsumoAlimentar', N'223272')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (404, N'ConsumoAlimentar', N'223293')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (405, N'ConsumoAlimentar', N'322415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (406, N'ConsumoAlimentar', N'322430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (407, N'ConsumoAlimentar', N'322405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (408, N'ConsumoAlimentar', N'322425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (409, N'ConsumoAlimentar', N'352210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (410, N'ConsumoAlimentar', N'515105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (411, N'ConsumoAlimentar', N'515140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (412, N'ConsumoAlimentar', N'515130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (413, N'ConsumoAlimentar', N'515125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (414, N'ConsumoAlimentar', N'515120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (415, N'ConsumoAlimentar', N'515310')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (416, N'ConsumoAlimentar', N'322230')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (417, N'ConsumoAlimentar', N'322250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (418, N'ConsumoAlimentar', N'322205')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (419, N'ConsumoAlimentar', N'322245')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (420, N'ConsumoAlimentar', N'322210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (421, N'ConsumoAlimentar', N'322405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (422, N'ConsumoAlimentar', N'322425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (423, N'AvaliacaoElegibilidade', N'2231F8')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (424, N'AvaliacaoElegibilidade', N'2231A2')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (425, N'AvaliacaoElegibilidade', N'2231F9')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (426, N'AvaliacaoElegibilidade', N'223505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (427, N'AvaliacaoElegibilidade', N'223510')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (428, N'AvaliacaoElegibilidade', N'223565')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (429, N'AvaliacaoElegibilidade', N'223530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (430, N'AvaliacaoElegibilidade', N'223545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (431, N'AvaliacaoElegibilidade', N'223550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (432, N'AvaliacaoElegibilidade', N'223555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (433, N'AvaliacaoElegibilidade', N'223560')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (434, N'AvaliacaoElegibilidade', N'223650')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (435, N'AvaliacaoElegibilidade', N'223660')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (436, N'AvaliacaoElegibilidade', N'223655')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (437, N'AvaliacaoElegibilidade', N'223605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (438, N'AvaliacaoElegibilidade', N'223630')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (439, N'AvaliacaoElegibilidade', N'223635')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (440, N'AvaliacaoElegibilidade', N'225105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (441, N'AvaliacaoElegibilidade', N'225115')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (442, N'AvaliacaoElegibilidade', N'225120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (443, N'AvaliacaoElegibilidade', N'225125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (444, N'AvaliacaoElegibilidade', N'225142')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (445, N'AvaliacaoElegibilidade', N'225130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (446, N'AvaliacaoElegibilidade', N'225135')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (447, N'AvaliacaoElegibilidade', N'225140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (448, N'AvaliacaoElegibilidade', N'225150')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (449, N'AvaliacaoElegibilidade', N'225155')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (450, N'AvaliacaoElegibilidade', N'225160')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (451, N'AvaliacaoElegibilidade', N'225165')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (452, N'AvaliacaoElegibilidade', N'225170')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (453, N'AvaliacaoElegibilidade', N'225180')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (454, N'AvaliacaoElegibilidade', N'225195')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (455, N'AvaliacaoElegibilidade', N'225103')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (456, N'AvaliacaoElegibilidade', N'225109')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (457, N'AvaliacaoElegibilidade', N'225112')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (458, N'AvaliacaoElegibilidade', N'225124')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (459, N'AvaliacaoElegibilidade', N'225127')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (460, N'AvaliacaoElegibilidade', N'225133')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (461, N'AvaliacaoElegibilidade', N'225136')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (462, N'AvaliacaoElegibilidade', N'225139')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (463, N'AvaliacaoElegibilidade', N'225154')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (464, N'AvaliacaoElegibilidade', N'225210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (465, N'AvaliacaoElegibilidade', N'225225')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (466, N'AvaliacaoElegibilidade', N'225230')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (467, N'AvaliacaoElegibilidade', N'225203')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (468, N'AvaliacaoElegibilidade', N'225250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (469, N'AvaliacaoElegibilidade', N'225255')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (470, N'AvaliacaoElegibilidade', N'225260')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (471, N'AvaliacaoElegibilidade', N'225265')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (472, N'AvaliacaoElegibilidade', N'225270')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (473, N'AvaliacaoElegibilidade', N'225275')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (474, N'AvaliacaoElegibilidade', N'225285')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (475, N'AvaliacaoElegibilidade', N'225320')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (476, N'AvaliacaoElegibilidade', N'225350')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (477, N'AvaliacaoElegibilidade', N'251605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (478, N'AtendimentoDomiciliar', N'2231F8')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (479, N'AtendimentoDomiciliar', N'2231A2')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (480, N'AtendimentoDomiciliar', N'2231F9')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (481, N'AtendimentoDomiciliar', N'223204')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (482, N'AtendimentoDomiciliar', N'223208')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (483, N'AtendimentoDomiciliar', N'223280')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (484, N'AtendimentoDomiciliar', N'223212')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (485, N'AtendimentoDomiciliar', N'223220')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (486, N'AtendimentoDomiciliar', N'223276')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (487, N'AtendimentoDomiciliar', N'223288')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (488, N'AtendimentoDomiciliar', N'223232')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (489, N'AtendimentoDomiciliar', N'223236')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (490, N'AtendimentoDomiciliar', N'223240')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (491, N'AtendimentoDomiciliar', N'223248')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (492, N'AtendimentoDomiciliar', N'223256')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (493, N'AtendimentoDomiciliar', N'223260')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (494, N'AtendimentoDomiciliar', N'223264')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (495, N'AtendimentoDomiciliar', N'223268')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (496, N'AtendimentoDomiciliar', N'223272')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (497, N'AtendimentoDomiciliar', N'223293')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (498, N'AtendimentoDomiciliar', N'223405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (499, N'AtendimentoDomiciliar', N'223415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (500, N'AtendimentoDomiciliar', N'223410')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (501, N'AtendimentoDomiciliar', N'223430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (502, N'AtendimentoDomiciliar', N'223445')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (503, N'AtendimentoDomiciliar', N'223505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (504, N'AtendimentoDomiciliar', N'223510')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (505, N'AtendimentoDomiciliar', N'223565')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (506, N'AtendimentoDomiciliar', N'223530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (507, N'AtendimentoDomiciliar', N'223545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (508, N'AtendimentoDomiciliar', N'223550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (509, N'AtendimentoDomiciliar', N'223555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (510, N'AtendimentoDomiciliar', N'223560')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (511, N'AtendimentoDomiciliar', N'223650')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (512, N'AtendimentoDomiciliar', N'223660')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (513, N'AtendimentoDomiciliar', N'223655')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (514, N'AtendimentoDomiciliar', N'223605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (515, N'AtendimentoDomiciliar', N'223630')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (516, N'AtendimentoDomiciliar', N'223635')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (517, N'AtendimentoDomiciliar', N'223710')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (518, N'AtendimentoDomiciliar', N'223810')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (519, N'AtendimentoDomiciliar', N'223815')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (520, N'AtendimentoDomiciliar', N'223830')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (521, N'AtendimentoDomiciliar', N'223840')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (522, N'AtendimentoDomiciliar', N'223915')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (523, N'AtendimentoDomiciliar', N'223905')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (524, N'AtendimentoDomiciliar', N'225105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (525, N'AtendimentoDomiciliar', N'225115')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (526, N'AtendimentoDomiciliar', N'225120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (527, N'AtendimentoDomiciliar', N'225125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (528, N'AtendimentoDomiciliar', N'225142')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (529, N'AtendimentoDomiciliar', N'225130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (530, N'AtendimentoDomiciliar', N'225135')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (531, N'AtendimentoDomiciliar', N'225140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (532, N'AtendimentoDomiciliar', N'225150')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (533, N'AtendimentoDomiciliar', N'225155')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (534, N'AtendimentoDomiciliar', N'225160')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (535, N'AtendimentoDomiciliar', N'225165')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (536, N'AtendimentoDomiciliar', N'225170')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (537, N'AtendimentoDomiciliar', N'225180')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (538, N'AtendimentoDomiciliar', N'225195')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (539, N'AtendimentoDomiciliar', N'225103')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (540, N'AtendimentoDomiciliar', N'225109')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (541, N'AtendimentoDomiciliar', N'225112')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (542, N'AtendimentoDomiciliar', N'225124')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (543, N'AtendimentoDomiciliar', N'225127')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (544, N'AtendimentoDomiciliar', N'225133')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (545, N'AtendimentoDomiciliar', N'225136')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (546, N'AtendimentoDomiciliar', N'225139')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (547, N'AtendimentoDomiciliar', N'225154')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (548, N'AtendimentoDomiciliar', N'225210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (549, N'AtendimentoDomiciliar', N'225225')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (550, N'AtendimentoDomiciliar', N'225230')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (551, N'AtendimentoDomiciliar', N'225203')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (552, N'AtendimentoDomiciliar', N'225250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (553, N'AtendimentoDomiciliar', N'225255')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (554, N'AtendimentoDomiciliar', N'225260')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (555, N'AtendimentoDomiciliar', N'225265')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (556, N'AtendimentoDomiciliar', N'225270')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (557, N'AtendimentoDomiciliar', N'225275')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (558, N'AtendimentoDomiciliar', N'225285')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (559, N'AtendimentoDomiciliar', N'225320')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (560, N'AtendimentoDomiciliar', N'225350')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (561, N'AtendimentoDomiciliar', N'251550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (562, N'AtendimentoDomiciliar', N'251555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (563, N'AtendimentoDomiciliar', N'251510')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (564, N'AtendimentoDomiciliar', N'251540')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (565, N'AtendimentoDomiciliar', N'251505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (566, N'AtendimentoDomiciliar', N'251520')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (567, N'AtendimentoDomiciliar', N'251525')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (568, N'AtendimentoDomiciliar', N'251530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (569, N'AtendimentoDomiciliar', N'251605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (570, N'AtendimentoDomiciliar', N'322230')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (571, N'AtendimentoDomiciliar', N'322250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (572, N'AtendimentoDomiciliar', N'322205')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (573, N'AtendimentoDomiciliar', N'322245')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (574, N'AtendimentoDomiciliar', N'322210')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (575, N'AtendimentoDomiciliar', N'322405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (576, N'AtendimentoDomiciliar', N'322425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (577, N'Complementar', N'2231F9')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (578, N'Complementar', N'223405')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (579, N'Complementar', N'223415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (580, N'Complementar', N'223430')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (581, N'Complementar', N'223445')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (582, N'Complementar', N'223425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (583, N'Complementar', N'223505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (584, N'Complementar', N'223565')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (585, N'Complementar', N'223530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (586, N'Complementar', N'223545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (587, N'Complementar', N'223550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (588, N'Complementar', N'223555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (589, N'Complementar', N'223560')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (590, N'Complementar', N'223650')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (591, N'Complementar', N'223605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (592, N'Complementar', N'223710')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (593, N'Complementar', N'223810')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (594, N'Complementar', N'223905')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (595, N'Complementar', N'2241E1')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (596, N'Complementar', N'225105')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (597, N'Complementar', N'225110')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (598, N'Complementar', N'225120')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (599, N'Complementar', N'225125')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (600, N'Complementar', N'225142')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (601, N'Complementar', N'225130')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (602, N'Complementar', N'225135')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (603, N'Complementar', N'225140')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (604, N'Complementar', N'225155')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (605, N'Complementar', N'225160')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (606, N'Complementar', N'225165')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (607, N'Complementar', N'225170')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (608, N'Complementar', N'225180')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (609, N'Complementar', N'225185')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (610, N'Complementar', N'225195')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (611, N'Complementar', N'225103')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (612, N'Complementar', N'225109')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (613, N'Complementar', N'225112')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (614, N'Complementar', N'225118')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (615, N'Complementar', N'225121')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (616, N'Complementar', N'225124')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (617, N'Complementar', N'225127')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (618, N'Complementar', N'225133')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (619, N'Complementar', N'225136')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (620, N'Complementar', N'225139')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (621, N'Complementar', N'225154')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (622, N'Complementar', N'225250')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (623, N'Complementar', N'225255')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (624, N'Complementar', N'225265')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (625, N'Complementar', N'225270')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (626, N'Complementar', N'225275')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (627, N'Complementar', N'225285')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (628, N'Complementar', N'225350')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (629, N'Complementar', N'226305')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (630, N'Complementar', N'234410')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (631, N'Complementar', N'239415')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (632, N'Complementar', N'239425')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (633, N'Complementar', N'251545')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (634, N'Complementar', N'251550')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (635, N'Complementar', N'251555')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (636, N'Complementar', N'251510')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (637, N'Complementar', N'251540')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (638, N'Complementar', N'251505')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (639, N'Complementar', N'251530')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (640, N'Complementar', N'251605')
GO
INSERT [dbo].[SIGSM_FichaProfissao] ([Id], [Ficha], [CBO]) VALUES (641, N'Complementar', N'515305')
GO
SET IDENTITY_INSERT [dbo].[SIGSM_FichaProfissao] OFF
GO


GO
PRINT N'Creating [dbo].[SIGSM_MicroArea_CredenciadoCidadao]...';


UPDATE TP_Sexo SET sigla = SUBSTRING(descricao, 1, 1)
GO

UPDATE menu SET ativo = 1 WHERE id_menu IN (17, 18)
UPDATE menu SET link = 'Transmissao' WHERE id_menu = 18
INSERT INTO menu
SELECT id_menu_pai, id_sistema, 'Acompanhamento', 'Transmissao/Relatorios', sublink, icone, ordem + 1, 1, id_user_cadastro, GETDATE(), (SELECT MAX(m.id_menu) + 1 FROM menu m)
FROM menu WHERE id_menu = 18
INSERT INTO menu
SELECT id_menu_pai, id_sistema, 'Configurações', 'Transmissao/Configuracoes', sublink, icone, ordem + 2, 1, id_user_cadastro, GETDATE(), (SELECT MAX(m.id_menu) + 1 FROM menu m)
FROM menu WHERE id_menu = 18

INSERT INTO Grupo_Menu (id_grupo, id_menu, ler, cadastrar, atualizar, excluir, imprimir, id_user_cadastro, data_cadastro)
SELECT id_grupo, c.id_menu,
ler, cadastrar, atualizar, excluir, imprimir,
id_user_cadastro,
GETDATE()
FROM Grupo_Menu gm
OUTER APPLY (SELECT m.id_menu FROM menu m WHERE m.id_menu_pai = 17 AND m.id_menu > 18) as c
WHERE gm.id_menu = 18
GO

/*Pointer used for text / image updates. This might not be needed, but is declared here just in case*/
DECLARE @pv binary(16)
UPDATE [dbo].[SIGSM_ServicoSerializador_Fichas] SET [Gerar]=1 WHERE [Ficha]=N'AtendimentoDomiciliar'
UPDATE [dbo].[SIGSM_ServicoSerializador_Fichas] SET [Gerar]=1 WHERE [Ficha]=N'AtendimentoIndividual'
UPDATE [dbo].[SIGSM_ServicoSerializador_Fichas] SET [Gerar]=1 WHERE [Ficha]=N'AtendimentoOdontologico'
UPDATE [dbo].[SIGSM_ServicoSerializador_Fichas] SET [Gerar]=1 WHERE [Ficha]=N'AtividadeColetiva'
UPDATE [dbo].[SIGSM_ServicoSerializador_Fichas] SET [Gerar]=1 WHERE [Ficha]=N'AvaliacaoElegibilidade'
UPDATE [dbo].[SIGSM_ServicoSerializador_Fichas] SET [Gerar]=1 WHERE [Ficha]=N'Complementar'
UPDATE [dbo].[SIGSM_ServicoSerializador_Fichas] SET [Gerar]=1 WHERE [Ficha]=N'ConsumoAlimentar'
UPDATE [dbo].[SIGSM_ServicoSerializador_Fichas] SET [Gerar]=1 WHERE [Ficha]=N'Procedimento'
INSERT INTO [dbo].[SIGSM_ServicoSerializador_Config] ([Configuracao], [Valor]) VALUES (N'ApiPath', N'/sigsm/v2/ESUS/fichas')

UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 29;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 19;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 1;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 4;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 5;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 7;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 8;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 10;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 13;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 14;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 15;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 6;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 16;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 17;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 18;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'T' WHERE id = 21;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 20;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 2;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 23;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 9;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 11;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 25;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 26;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 27;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 28;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 22;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 3;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 24;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 12;
UPDATE SIGSM_Praticas_Temas_para_Saude SET tipo = 'P' WHERE id = 30;

DELETE c FROM SIGSM_ServicoSerializador_Config c WHERE c.Configuracao = 'runningOn';
GO

GO
CREATE TABLE [dbo].[SIGSM_MicroArea_CredenciadoCidadao] (
    [id]                 INT          IDENTITY (1, 1) NOT NULL,
    [NumContrato]        INT          NOT NULL,
    [Codigo]             DECIMAL (18) NOT NULL,
    [idMaCredVinc]       INT          NOT NULL,
    [RealizarDownload]   BIT          NOT NULL,
    [DownloadDomiciliar] DATETIME     NULL,
    [DownloadIndividual] DATETIME     NULL,
    PRIMARY KEY CLUSTERED ([id] ASC)
);


GO
PRINT N'Creating [dbo].[SIGSM_MicroArea_CredenciadoVinc]...';


GO
CREATE TABLE [dbo].[SIGSM_MicroArea_CredenciadoVinc] (
    [id]                 INT IDENTITY (1, 1) NOT NULL,
    [idMicroAreaUnidade] INT NOT NULL,
    [NumContrato]        INT NOT NULL,
    [CodCred]            INT NOT NULL,
    [ItemVinc]           INT NOT NULL,
    PRIMARY KEY CLUSTERED ([id] ASC)
);


GO
PRINT N'Creating [dbo].[SIGSM_MicroArea_Unidade]...';


GO
CREATE TABLE [dbo].[SIGSM_MicroArea_Unidade] (
    [id]          INT      IDENTITY (1, 1) NOT NULL,
    [MicroArea]   CHAR (2) NOT NULL,
    [NumContrato] INT      NOT NULL,
    [CodSetor]    INT      NOT NULL,
    PRIMARY KEY CLUSTERED ([id] ASC)
);


GO
PRINT N'Creating [dbo].[SIGSM_MicroAreas]...';


GO
CREATE TABLE [dbo].[SIGSM_MicroAreas] (
    [Codigo]    CHAR (2)     NOT NULL,
    [Descricao] VARCHAR (80) NOT NULL,
    PRIMARY KEY CLUSTERED ([Codigo] ASC)
);


GO
PRINT N'Creating unnamed constraint on [api].[Documentos]...';


GO
ALTER TABLE [api].[Documentos]
    ADD DEFAULT ((22)) FOR [NumContrato];


GO
PRINT N'Creating unnamed constraint on [api].[Documentos]...';


GO
ALTER TABLE [api].[Documentos]
    ADD DEFAULT (getdate()) FOR [Data];


GO
PRINT N'Creating unnamed constraint on [api].[Documentos]...';


GO
ALTER TABLE [api].[Documentos]
    ADD DEFAULT (newid()) FOR [Id];


GO
PRINT N'Creating unnamed constraint on [api].[Documentos]...';


GO
ALTER TABLE [api].[Documentos] WITH NOCHECK
    ADD FOREIGN KEY ([IdIdentificacaoUsuarioCidadao]) REFERENCES [api].[IdentificacaoUsuarioCidadao] ([id]);


GO
PRINT N'Creating unnamed constraint on [api].[Documentos]...';


GO
ALTER TABLE [api].[Documentos] WITH NOCHECK
    ADD FOREIGN KEY ([NumContrato], [IdTipoDocumento]) REFERENCES [dbo].[ASSMED_TipoDocPessoal] ([NumContrato], [CodTpDocP]);


GO
PRINT N'Creating unnamed constraint on [dbo].[SIGSM_MicroArea_CredenciadoCidadao]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_CredenciadoCidadao] WITH NOCHECK
    ADD FOREIGN KEY ([NumContrato]) REFERENCES [dbo].[ASSMED_Contratos] ([NumContrato]);


GO
PRINT N'Creating unnamed constraint on [dbo].[SIGSM_MicroArea_CredenciadoCidadao]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_CredenciadoCidadao] WITH NOCHECK
    ADD FOREIGN KEY ([idMaCredVinc]) REFERENCES [dbo].[SIGSM_MicroArea_CredenciadoVinc] ([id]);


GO
PRINT N'Creating [dbo].[FK_Chk_Cadastro_Pessoa]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_CredenciadoCidadao] WITH NOCHECK
    ADD CONSTRAINT [FK_Chk_Cadastro_Pessoa] FOREIGN KEY ([NumContrato], [Codigo]) REFERENCES [dbo].[ASSMED_Cadastro] ([NumContrato], [Codigo]);


GO
PRINT N'Creating unnamed constraint on [dbo].[SIGSM_MicroArea_CredenciadoVinc]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_CredenciadoVinc] WITH NOCHECK
    ADD FOREIGN KEY ([idMicroAreaUnidade]) REFERENCES [dbo].[SIGSM_MicroArea_Unidade] ([id]);


GO
PRINT N'Creating unnamed constraint on [dbo].[SIGSM_MicroArea_CredenciadoVinc]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_CredenciadoVinc] WITH NOCHECK
    ADD FOREIGN KEY ([NumContrato]) REFERENCES [dbo].[ASSMED_Contratos] ([NumContrato]);


GO
PRINT N'Creating [dbo].[FK_MicroArea_Credenciado]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_CredenciadoVinc] WITH NOCHECK
    ADD CONSTRAINT [FK_MicroArea_Credenciado] FOREIGN KEY ([NumContrato], [CodCred]) REFERENCES [dbo].[AS_Credenciados] ([NumContrato], [CodCred]);


GO
PRINT N'Creating [dbo].[FK_MicroArea_CredenciadoVinc]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_CredenciadoVinc] WITH NOCHECK
    ADD CONSTRAINT [FK_MicroArea_CredenciadoVinc] FOREIGN KEY ([NumContrato], [CodCred], [ItemVinc]) REFERENCES [dbo].[AS_CredenciadosVinc] ([NumContrato], [CodCred], [ItemVinc]);


GO
PRINT N'Creating unnamed constraint on [dbo].[SIGSM_MicroArea_Unidade]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_Unidade] WITH NOCHECK
    ADD FOREIGN KEY ([MicroArea]) REFERENCES [dbo].[SIGSM_MicroAreas] ([Codigo]);


GO
PRINT N'Creating unnamed constraint on [dbo].[SIGSM_MicroArea_Unidade]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_Unidade] WITH NOCHECK
    ADD FOREIGN KEY ([NumContrato]) REFERENCES [dbo].[ASSMED_Contratos] ([NumContrato]);


GO
PRINT N'Creating [dbo].[FK_MicroArea_Unidade]...';


GO
ALTER TABLE [dbo].[SIGSM_MicroArea_Unidade] WITH NOCHECK
    ADD CONSTRAINT [FK_MicroArea_Unidade] FOREIGN KEY ([NumContrato], [CodSetor]) REFERENCES [dbo].[Setores] ([NumContrato], [CodSetor]);


GO
PRINT N'Altering [dbo].[VW_FichaCadastroDomiciliarTerritorial]...';


GO

ALTER VIEW [dbo].[VW_FichaCadastroDomiciliarTerritorial] AS
	 SELECT STUFF((
				SELECT ',' + CAST(ad.id_tp_animal AS NVARCHAR(18))
				  FROM api.AnimalNoDomicilio AS ad
				 WHERE ad.id_cadastro_domiciliar = cd.id
				   FOR XML PATH(''), TYPE
			).value('.', 'nvarchar(max)'), 1, 1, '') AS LstAnimaisNoDomicilio,
			cd.fichaAtualizada AS FichaAtualizada,
			cd.quantosAnimaisNoDomicilio AS QuantosAnimaisNoDomicilio,
			cd.stAnimaisNoDomicilio AS StAnimaisNoDomicilio,
			cd.statusTermoRecusa AS StatusTermoRecusa,
			3 AS TpCdsOrigem,
			cd.id AS Uuid,
			cd.uuidFichaOriginadora AS UuidFichaOriginadora,
			cd.tipoDeImovel AS TipoDeImovel,
			ult.dataAtendimento AS DataAtendimento,
		(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
		ult.cnes AS CNES
	   FROM api.CadastroDomiciliar AS cd
 INNER JOIN api.UnicaLotacaoTransport AS ult
		 ON cd.headerTransport = ult.id
 INNER JOIN api.OrigemVisita AS ov
		 ON ult.token = ov.token
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = cd.id
	  WHERE ov.enviarParaThrift = 1
		AND ov.finalizado = 1
		AND ISNULL(enviado, 0) = 0
		AND 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'CadastroDomiciliar')
GO
PRINT N'Altering [dbo].[VW_FichaCadastroDomiciliarTerritorial_CondicaoMoradia]...';


GO

ALTER VIEW [dbo].[VW_FichaCadastroDomiciliarTerritorial_CondicaoMoradia] AS
	 SELECT cd.id AS Uuid,
			cm.abastecimentoAgua AS AbastecimentoAgua,
			cm.areaProducaoRural AS AreaProducaoRural,
			cm.destinoLixo AS DestinoLixo,
			cm.formaEscoamentoBanheiro AS FormaEscoamentoBanheiro,
			cm.localizacao AS Localizacao,
			cm.materialPredominanteParedesExtDomicilio AS MaterialPredominanteParedesExtDomicilio,
			(CASE cm.nuComodos WHEN 0 THEN NULL ELSE cm.nuComodos END) AS NuComodos,
			cm.nuMoradores AS NuMoradores,
			cm.situacaoMoradiaPosseTerra AS SituacaoMoradiaPosseTerra,
			cm.stDisponibilidadeEnergiaEletrica AS StDisponibilidadeEnergiaEletrica,
			cm.tipoAcessoDomicilio AS TipoAcessoDomicilio,
			cm.tipoDomicilio AS TipoDomicilio,
			cm.aguaConsumoDomicilio AS AguaConsumoDomicilio
	   FROM api.CondicaoMoradia AS cm
 INNER JOIN api.CadastroDomiciliar AS cd
		 ON cd.condicaoMoradia = cm.id
GO
PRINT N'Refreshing [dbo].[VW_FichaCadastroDomiciliarTerritorial_EnderecoLocalPermanencia]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_FichaCadastroDomiciliarTerritorial_EnderecoLocalPermanencia]';


GO
PRINT N'Refreshing [dbo].[VW_FichaCadastroDomiciliarTerritorial_FamiliaRow]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_FichaCadastroDomiciliarTerritorial_FamiliaRow]';


GO
PRINT N'Refreshing [dbo].[VW_FichaCadastroDomiciliarTerritorial_InstituicaoPermanencia]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_FichaCadastroDomiciliarTerritorial_InstituicaoPermanencia]';


GO
PRINT N'Altering [dbo].[VW_FichaCadastroDomiciliarTerritorial_UnicaLotacaoHeader]...';


GO

ALTER VIEW [dbo].[VW_FichaCadastroDomiciliarTerritorial_UnicaLotacaoHeader] AS
	 SELECT cd.id AS Uuid,
			ult.profissionalCNS AS ProfissionalCNS,
			ult.cboCodigo_2002 AS CboCodigo_2002,
			ult.cnes AS Cnes,
			ult.ine AS Ine,
			ult.dataAtendimento AS DataAtendimento,
			ult.codigoIbgeMunicipio AS CodigoIbgeMunicipio
	   FROM api.CadastroDomiciliar AS cd
 INNER JOIN api.UnicaLotacaoTransport AS ult
		 ON cd.headerTransport = ult.id
 INNER JOIN api.OrigemVisita AS ov
		 ON ult.token = ov.token
GO
PRINT N'Altering [dbo].[VW_FichaCadastroIndividual]...';


GO

ALTER VIEW [dbo].[VW_FichaCadastroIndividual] AS
	 SELECT ci.fichaAtualizada AS FichaAtualizada,
			ci.statusTermoRecusaCadastroIndividualAtencaoBasica AS StatusTermoRecusaCadastroIndividualAtencaoBasica,
			3 AS TpCdsOrigem,
			ci.id AS Uuid,
			ci.uuidFichaOriginadora AS UuidFichaOriginadora,
			ult.dataAtendimento AS DataAtendimento,
			(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
			ult.cnes AS CNES
	   FROM api.CadastroIndividual AS ci
 INNER JOIN api.UnicaLotacaoTransport AS ult
		 ON ci.headerTransport = ult.id
 INNER JOIN api.OrigemVisita AS ov
		 ON ult.token = ov.token
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = ci.id
	  WHERE ov.enviarParaThrift = 1
		AND ov.finalizado = 1
		AND ISNULL(enviado, 0) = 0
		AND 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'CadastroIndividual')
GO
PRINT N'Refreshing [dbo].[VW_FichaCadastroIndividual_CondicoesDeSaude]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_FichaCadastroIndividual_CondicoesDeSaude]';


GO
PRINT N'Refreshing [dbo].[VW_FichaCadastroIndividual_EmSituacaoDeRua]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_FichaCadastroIndividual_EmSituacaoDeRua]';


GO
PRINT N'Altering [dbo].[VW_FichaCadastroIndividual_IdentificacaoUsuarioCidadao]...';


GO

ALTER VIEW [dbo].[VW_FichaCadastroIndividual_IdentificacaoUsuarioCidadao] AS
	 SELECT ci.id AS Uuid,
			iuc.nomeSocial AS NomeSocial,
			(CASE iuc.nacionalidadeCidadao WHEN 1 THEN
			iuc.codigoIbgeMunicipioNascimento
			ELSE NULL END) AS CodigoIbgeMunicipioNascimento,
			iuc.dataNascimentoCidadao AS DataNascimentoCidadao,
			iuc.desconheceNomeMae AS DesconheceNomeMae,
			iuc.emailCidadao AS EmailCidadao,
			iuc.nacionalidadeCidadao AS NacionalidadeCidadao,
			iuc.nomeCidadao AS NomeCidadao,
			iuc.nomeMaeCidadao AS NomeMaeCidadao,
			iuc.cnsCidadao AS CnsCidadao,
			iuc.cnsResponsavelFamiliar AS CnsResponsavelFamiliar,
			iuc.telefoneCelular AS TelefoneCelular,
			iuc.numeroNisPisPasep AS NumeroNisPisPasep,
			(CASE iuc.nacionalidadeCidadao WHEN 1 THEN ISNULL(iuc.paisNascimento, 31) WHEN 2 THEN NULL ELSE iuc.paisNascimento END) AS PaisNascimento,
			iuc.racaCorCidadao AS RacaCorCidadao,
			iuc.sexoCidadao AS SexoCidadao,
			iuc.statusEhResponsavel AS StatusEhResponsavel,
			iuc.etnia AS Etnia,
			iuc.nomePaiCidadao AS NomePaiCidadao,
			iuc.desconheceNomePai AS DesconheceNomePai,
			iuc.dtNaturalizacao AS DtNaturalizacao,
			iuc.portariaNaturalizacao AS PortariaNaturalizacao,
			iuc.dtEntradaBrasil AS DtEntradaBrasil,
			(CASE iuc.stForaArea WHEN 1 THEN NULL ELSE iuc.microarea END) AS MicroArea,
			iuc.stForaArea AS StForaArea
	   FROM api.IdentificacaoUsuarioCidadao AS iuc
 INNER JOIN api.CadastroIndividual AS ci
		 ON ci.identificacaoUsuarioCidadao = iuc.id
		INNER JOIN ASSMED_Contratos ac ON ac.NumContrato = 22
GO
PRINT N'Refreshing [dbo].[VW_FichaCadastroIndividual_InformacoesSocioDemograficas]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_FichaCadastroIndividual_InformacoesSocioDemograficas]';


GO
PRINT N'Refreshing [dbo].[VW_FichaCadastroIndividual_SaidaCidadaoCadastro]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_FichaCadastroIndividual_SaidaCidadaoCadastro]';


GO
PRINT N'Altering [dbo].[VW_FichaCadastroIndividual_UnicaLotacaoHeader]...';


GO

ALTER VIEW [dbo].[VW_FichaCadastroIndividual_UnicaLotacaoHeader] AS
	 SELECT ci.id AS Uuid,
			ult.profissionalCNS AS ProfissionalCNS,
			ult.cboCodigo_2002 AS CboCodigo_2002,
			ult.cnes AS Cnes,
			ult.ine AS Ine,
			ult.dataAtendimento AS DataAtendimento,
			ult.codigoIbgeMunicipio AS CodigoIbgeMunicipio
	   FROM api.CadastroIndividual AS ci
 INNER JOIN api.UnicaLotacaoTransport AS ult
		 ON ci.headerTransport = ult.id
 INNER JOIN api.OrigemVisita AS ov
		 ON ult.token = ov.token
GO
PRINT N'Altering [dbo].[VW_FichaVisitaDomiciliarTerritorialChild]...';


GO
ALTER VIEW [dbo].[VW_FichaVisitaDomiciliarTerritorialChild] AS
	 SELECT ficha.uuidFicha AS UuidFicha,
			child.turno AS Turno,
			child.numProntuario AS NumProntuario,
			child.cnsCidadao AS CnsCidadao,
			child.dtNascimento AS DtNascimento,
			child.sexo AS Sexo,
			child.statusVisitaCompartilhadaOutroProfissional AS StatusVisitaCompartilhadaOutroProfissional,
			STUFF((SELECT ',' + CAST(motivo.codigo AS NVARCHAR(18))
					 FROM api.FichaVisitaDomiciliarChild_MotivoVisita AS motivo
					WHERE motivo.childId = child.childId
					  FOR XML PATH(''), TYPE
			).value('.', 'nvarchar(max)'), 1, 1, '') AS LstMotivosVisita,
			child.desfecho AS Desfecho,
			child.microarea AS MicroArea,
			child.stForaArea AS StForaArea,
			child.tipoDeImovel AS TipoDeImovel,
			child.pesoAcompanhamentoNutricional AS PesoAcompanhamentoNutricional,
			child.alturaAcompanhamentoNutricional AS AlturaAcompanhamentoNutricional,
			header.dataAtendimento AS DataAtendimento,
			child.DataRegistro AS DataRegistro
	   FROM api.FichaVisitaDomiciliarChild AS child
 INNER JOIN api.FichaVisitaDomiciliarMaster AS ficha
		 ON child.uuidFicha = ficha.uuidFicha
 INNER JOIN api.UnicaLotacaoTransport AS header
		 ON ficha.headerTransport = header.id
GO
PRINT N'Adding schema binding to [api].[VW_Profissional]...';


GO

ALTER VIEW [api].[VW_Profissional] WITH SCHEMABINDING AS
		 SELECT ROW_NUMBER() OVER (ORDER BY (SELECT NULL))                  AS [id],
                RTRIM(LTRIM(doc.Numero)) COLLATE Latin1_General_CI_AI       AS [CNS],
                RTRIM(LTRIM(cad.Nome)) COLLATE Latin1_General_CI_AI         AS [Nome],
                RTRIM(LTRIM(cbo.CodProfTab)) COLLATE Latin1_General_CI_AI   AS [CBO],
                RTRIM(LTRIM(cbo.DesProfTab)) COLLATE Latin1_General_CI_AI   AS [Profissao],
                RTRIM(LTRIM(vinc.CNESLocal)) COLLATE Latin1_General_CI_AI   AS [CNES],
                RTRIM(LTRIM(setor.DesSetor)) COLLATE Latin1_General_CI_AI   AS [Unidade],
                RTRIM(LTRIM(ine.Numero)) COLLATE Latin1_General_CI_AI       AS [INE],
                RTRIM(LTRIM(ine.Descricao)) COLLATE Latin1_General_CI_AI    AS [Equipe],
				CAST(cad.Codigo AS INT) AS [CodUsu]
		   FROM [dbo].[ASSMED_Cadastro]					                    AS cad
	 INNER JOIN [dbo].[ASSMED_CadastroDocPessoal]		                    AS doc
			 ON cad.Codigo = doc.Codigo                 
	 INNER JOIN [dbo].[AS_CREDENCIADOS]					                    AS cred
			 ON cad.Codigo = cred.Codigo                    
	 INNER JOIN [dbo].[AS_CredenciadosVinc]				                    AS vinc
			 ON cred.CodCred = vinc.CodCred
     INNER JOIN [dbo].[AS_ProfissoesTab]                                    AS cbo
             ON RTRIM(LTRIM(vinc.CodProfTab)) COLLATE Latin1_General_CI_AI = RTRIM(LTRIM(cbo.CodProfTab))  COLLATE Latin1_General_CI_AI
     INNER JOIN [dbo].[AS_SetoresPar]                                       AS par
             ON RTRIM(LTRIM(vinc.CNESLocal)) COLLATE Latin1_General_CI_AI = RTRIM(LTRIM(par.CNES)) COLLATE Latin1_General_CI_AI
	 INNER JOIN [dbo].[Setores]                                             AS setor
             ON par.CodSetor = setor.CodSetor
            AND par.Codigo = setor.Codigo
      LEFT JOIN [dbo].[SetoresINEs]                                         AS ine
             ON setor.CodSetor = ine.CodSetor
            AND RTRIM(LTRIM(vinc.CodINE)) COLLATE Latin1_General_CI_AI = RTRIM(LTRIM(ine.CodINE)) COLLATE Latin1_General_CI_AI
	      WHERE doc.CodTpDocP = 6
		    AND cbo.CodProfissao IS NOT NULL
			AND LEN(LTRIM(RTRIM(COALESCE(doc.Numero COLLATE Latin1_General_CI_AI, '')))) > 0
			AND LEN(LTRIM(RTRIM(COALESCE(vinc.CNESLocal COLLATE Latin1_General_CI_AI, '')))) > 0
	   GROUP BY RTRIM(LTRIM(doc.Numero)) COLLATE Latin1_General_CI_AI,
                RTRIM(LTRIM(cad.Nome)) COLLATE Latin1_General_CI_AI,
                RTRIM(LTRIM(cbo.CodProfTab)) COLLATE Latin1_General_CI_AI,
                RTRIM(LTRIM(cbo.DesProfTab)) COLLATE Latin1_General_CI_AI,
                RTRIM(LTRIM(vinc.CNESLocal)) COLLATE Latin1_General_CI_AI,
                RTRIM(LTRIM(setor.DesSetor)) COLLATE Latin1_General_CI_AI,
                RTRIM(LTRIM(ine.Numero)) COLLATE Latin1_General_CI_AI,
                RTRIM(LTRIM(ine.Descricao)) COLLATE Latin1_General_CI_AI,
				cad.Codigo;
GO
PRINT N'Refreshing [dbo].[ProAtendimentos_Listagem]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[ProAtendimentos_Listagem]';


GO
PRINT N'Refreshing [dbo].[VW_ATENDIMENTO_DOMICILIAR]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_ATENDIMENTO_DOMICILIAR]';


GO
PRINT N'Refreshing [dbo].[VW_ATENDIMENTO_INDIVIDUAL]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_ATENDIMENTO_INDIVIDUAL]';


GO
PRINT N'Refreshing [dbo].[VW_ATENDIMENTO_ODONTOLOGICO]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_ATENDIMENTO_ODONTOLOGICO]';


GO
PRINT N'Refreshing [dbo].[VW_ATIVIDADE_COLETIVA]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_ATIVIDADE_COLETIVA]';


GO
PRINT N'Refreshing [dbo].[VW_AVALIACAO_ELEGIBILIDADE_ADMISSAO]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_AVALIACAO_ELEGIBILIDADE_ADMISSAO]';


GO
PRINT N'Refreshing [dbo].[VW_COMP_FAMILIAR]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_COMP_FAMILIAR]';


GO
PRINT N'Refreshing [dbo].[VW_COMPLEMENTAR]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_COMPLEMENTAR]';


GO
PRINT N'Refreshing [dbo].[VW_ConsultaCadastrosIndividuais]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_ConsultaCadastrosIndividuais]';


GO
PRINT N'Refreshing [dbo].[VW_FichaAtendimentoDomiciliar_HeaderTransport]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_FichaAtendimentoDomiciliar_HeaderTransport]';


GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoDomiciliarChild]...';


GO

ALTER VIEW [dbo].[VW_FichaAtendimentoDomiciliarChild] AS
 select ate.guid_esus as uuidFicha,
        tur.id AS turno,
		(CASE LEN(RTRIM(LTRIM(dpe.Numero))) WHEN 15 THEN RTRIM(LTRIM(dpe.Numero)) ELSE NULL END) as cnsCidadao,
	    pac.data_nascimento as dataNascimento,
	    sex.codigo AS sexo,
	    pac.local_atendimento as localDeAtendimento,
        mad.id AS atencaoDomiciliarModalidade,
	    ta.id_tipo_atendimento as tipoAtendimento,
	    dbo.FN_ParseCondicoesAvaliadas(pac.condicao) as condicoes,
		pac.cid as cid,
	    pac.ciap as ciap,                  
        sdcm.codigo as condutaDesfecho,
		ate.guid_esus AS uuidAtendimentoDomiciliar,
		ate.id As idAtendimentoDomiciliar,
		pac.procedimentos AS procs,
		ISNULL(
		STUFF((
			select ',' + sadp.sigtap from SIGSM_Atendimento_Domiciliar_Procedimentos sadp
			 left JOIN dbo.SIGSM_Atendimento_Domiciliar_SIGTAP sigtap on sigtap.id = sadp.sigtap
			 where sadp.id_atendimento_usuario = ate.id
			   FOR XML PATH(''), TYPE
		).value('.', 'varchar(max)'), 1, 1, ''), '') AS oprocs,
		pac.id as Id
    from SIGSM_Atendimento_Domiciliar_Paciente pac
	    left outer join SIGSM_Atendimento_Domiciliar ate on pac.id_atendimento_domiciliar = ate.id
	    left outer join ASSMED_Cadastro cad on pac.id_identificacao_usuario = cad.Codigo
	    left outer join ASSMED_PesFisica fis on cad.Codigo = fis.Codigo and cad.NumContrato = fis.NumContrato
	    left outer join ASSMED_CadastroDocPessoal dpe on dpe.NumContrato = cad.NumContrato AND dpe.Codigo = cad.Codigo AND dpe.CodTpDocP = 6	
		left outer join dbo.SIGSM_Turno AS tur ON pac.turno = tur.sigla
		left outer join dbo.TP_Sexo AS sex ON pac.sexo = sex.sigla
		left outer join dbo.SIGSM_ModalidadeAD AS mad ON pac.modalidade_ad = mad.descricao
		left outer join dbo.Tipo_Atendimento AS ta ON pac.id_tipo_atendimento = ta.id_tipo_atendimento
		left outer join dbo.SIGSM_Domiciliar_Conduta_Motivo AS sdcm ON pac.conduta_motivo_saida = sdcm.Id_conduta
GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoIndividual_HeaderTransport]...';


GO

ALTER VIEW [dbo].[VW_FichaAtendimentoIndividual_HeaderTransport] AS
 select atendIndividual.guid_esus as UuidFicha,
	    ltrim(rtrim(dpe.Numero)) as ProfissionalCNS,
	    rtrim(ltrim(pro.cbo)) as CboCodigo_2002,
	    atendIndividual.codigo_cnes_unidade as Cnes,
	    snes.Numero as Ine,
	    atendIndividual.data_atendimento as DataAtendimento,
	    con.CodigoIbgeMunicipio as CodigoIbgeMunicipio,
		atendIndividual.guid_esus AS Uuid_AtendimentoDomiciliar,
		atendIndividual.id As Id_AtendimentoDomiciliar
    from Atendimento_Individual_Profissional_Saude pro
    left outer join ASSMED_Cadastro cad on pro.id_profissional_saude = cad.Codigo
    left outer join Atendimento_Individual atendIndividual on atendIndividual.id = pro.id_atendimento_individual
    INNER JOIN ASSMED_CadastroDocPessoal dpe on dpe.NumContrato = cad.NumContrato AND dpe.Codigo = cad.Codigo AND dpe.CodTpDocP = 6
    left join SetoresInes snes on (atendIndividual.codigo_equipe_ine = snes.CodINE)
	inner join ASSMED_Contratos con on con.NumContrato = 22
GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoIndividualChild]...';


GO

ALTER VIEW [dbo].[VW_FichaAtendimentoIndividualChild] AS
 select usu.id as Id,
        ate.guid_esus as UuidFicha,
        usu.numero_prontuario as NumeroProntuario,
        (CASE LEN(RTRIM(LTRIM(usu.numero_cartao_sus))) WHEN 15 THEN RTRIM(LTRIM(usu.numero_cartao_sus)) ELSE NULL END) as Cns,
        usu.data_nascimento as DataNascimento ,
        usu.local_atendimento as LocalDeAtendimento,
		sex.codigo AS Sexo,
        tur.id AS Turno,
        usu.id_tipo_atendimento as TipoAtendimento,
        usu.peso as PesoAcompanhamentoNutricional,
        usu.altura as AlturaAcompanhamentoNutricional,
        usu.crianca_aleitamento_materno as AleitamentoMaterno,
        usu.gestante_dum as DumDaGestante,
        usu.gestante_idade_gestacional as IdadeGestacional,
        mad.id As AtencaoDomiciliarModalidade,
		NULL AS ProblemaCondicaoAvaliada,
		STUFF((
			select ',' + saieab.codigoAB from Atendimento_Individual_Exames AS aie
			inner join SIGSM_Atendimento_Individual_ExamesAB AS saieab
			on aie.codigoAB = saieab.codigoAB
			WHERE aie.solicitado = 'S' and aie.id_atendimento = ate.id
			and aie.id_atendimento_usuario = usu.id
			   FOR XML PATH(''), TYPE
		).value('.', 'varchar(max)'), 1, 1, '') AS ExaSolicitados,
		STUFF((
			select ',' + saieab.codigoAB from Atendimento_Individual_Exames AS aie
			inner join SIGSM_Atendimento_Individual_ExamesAB AS saieab
			on aie.codigoAB = saieab.codigoAB
			WHERE aie.avaliado = 'A' and aie.id_atendimento = ate.id
			and aie.id_atendimento_usuario = usu.id
			   FOR XML PATH(''), TYPE
		).value('.', 'varchar(max)'), 1, 1, '') AS ExaAvaliados,
		CAST(CASE usu.vacinacao_em_dia WHEN 'Sim' THEN 1 ELSE 0 END AS BIT) as VacinaEmDia,
        CAST(CASE usu.ficou_em_observacao WHEN 'Sim' THEN 1 ELSE 0 END AS BIT) as FicouEmObservacao,
		STUFF((SELECT ','+CAST(nuasfs AS NVARCHAR(MAX)) FROM 
				Atendimento_Individual_Usuario u
				CROSS APPLY (
					VALUES
					(CASE WHEN ( avaliacao_diagnostico = 1 ) THEN 1 END),
					(CASE WHEN ( procedimentos_clinicos_terapeuticos = 1 ) THEN 2 END),
					(CASE WHEN ( prescricao_terapeutica = 1 ) THEN 3 END)
				) c ([nuasfs])
				WHERE u.id = usu.id
				FOR XML PATH(''), TYPE).value('.', 'nvarchar(max)'), 1, 1, '') AS Nuasfs,
		STUFF((SELECT ','+CAST(condutas AS NVARCHAR(MAX)) FROM 
				Atendimento_Individual_Usuario u
				CROSS APPLY (
					VALUES
					(CASE WHEN ( retorno_para_consulta_agendada = 1 ) THEN 1 END),
					(CASE WHEN ( retorno_para_cuidado_continuado_programado = 1 ) THEN 2 END),
					(CASE WHEN ( agendamento_para_grupos = 1 ) THEN 12 END),
					(CASE WHEN ( agendamento_para_nasf = 1 ) THEN 3 END),
					(CASE WHEN ( alta_do_episodio = 1 ) THEN 9 END),
					(CASE WHEN ( encaminhamento_interno_no_dia = 1 ) THEN 11 END),
					(CASE WHEN ( encaminhamento_para_servico_especializado = 1 ) THEN 4 END),
					(CASE WHEN ( encaminhamento_para_caps = 1 ) THEN 5 END),
					(CASE WHEN ( encaminhamento_para_internacao_hospitalar = 1 ) THEN 6 END),
					(CASE WHEN ( encaminhamento_para_urgencia = 1 ) THEN 7 END),
					(CASE WHEN ( encaminhamento_para_servico_de_atencao_domiciliar = 1 ) THEN 8 END),
					(CASE WHEN ( encaminhamento_intersetorial = 1 ) THEN 10 END)
				) c ([condutas])
				WHERE u.id = usu.id
				FOR XML PATH(''), TYPE).value('.', 'nvarchar(max)'), 1, 1, '') as condutas,
        CAST(CASE usu.gestante_gravidez_planejada WHEN 'Sim' THEN 1 ELSE 0 END AS BIT) AS StGravidezPlanejada,
        usu.gestante_partos as NuPartos,
        usu.gestante_gestas_previas as NuGestasPrevias,
        usu.racionalidade as RacionalidadeSaude,
		usu.perimetroCefalico as PerimetroCefalico
from Atendimento_Individual_Usuario usu left join Atendimento_Individual ate    on ( usu.id_atendimento_individual = ate.id )
                                        left join ASSMED_Cadastro cad           on ( usu.id_identificacao_usuario = cad.Codigo )
                                        left join ASSMED_CadastroDocPessoal dpe on ( usu.NumContrato = dpe.NumContrato )
																			    and dpe.Codigo = cad.Codigo
																			    and dpe.CodTpDocP = 6
										left join TP_Sexo sex on usu.sexo = sex.sigla
										left join SIGSM_Turno tur on usu.turno = tur.sigla
		left join dbo.SIGSM_ModalidadeAD AS mad ON usu.modalidade_ad = mad.descricao
GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoOdontologico_HeaderTransport]...';


GO


ALTER VIEW [dbo].[VW_FichaAtendimentoOdontologico_HeaderTransport] AS
select distinct odo.guid_esus as UuidFicha,
                dpe.Numero as ProfissionalCNS,
                rtrim(ltrim(pro.cbo)) as CboCodigo_2002,
                odo.codigo_cnes_unidade as Cnes,
                sti.Numero as Ine,
	            odo.data_atendimento as DataAtendimento,
	            pro.codibge_munic_nasc as CodigoIbgeMunicipio
            from SIGSM_Atendimento_Odontologico_Profissional pro
			left join SIGSM_Atendimento_Odontologico odo on ( pro.id_atendimento_odontologico = odo.id )
            left join ASSMED_Cadastro cad                on ( pro.id_profissional_saude = cad.Codigo )
            left join ASSMED_CadastroDocPessoal dpe      on ( dpe.NumContrato = cad.NumContrato ) 
			                                            and ( dpe.Codigo = cad.Codigo ) 
										                and ( dpe.CodTpDocP = 6 )
            left join SIGSM_Atendimento_Odontologico_Paciente pac on (pac.id_atendimento_odontologico = odo.id)  
            left join SetoresINEs sti                    on ( odo.codigo_equipe_ine = sti.CodINE )
GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoOdontologicoChild]...';


GO

ALTER VIEW [dbo].[VW_FichaAtendimentoOdontologicoChild] AS
select distinct pac.id as Id,
                odo.guid_esus as UuidFicha,
                pac.data_nascimento as DtNascimento,
                (CASE LEN(RTRIM(LTRIM(pac.numero_cartao_sus))) WHEN 15 THEN RTRIM(LTRIM(pac.numero_cartao_sus)) ELSE NULL END) as CnsCidadao,
                pac.numero_prontuario as NumProntuario,	
                CAST(ISNULL(pac.Gestante, 0) AS BIT) As Gestante,
                CAST(ISNULL(pac.paciente_necessidades_especiais, 0) AS BIT) As NecessidadesEspeciais,	
                pac.local_atendimento as LocalAtendimento,
                pac.id_tipo_atendimento as TipoAtendimento,
                REPLACE(LTRIM(RTRIM(pac.conduta)), ' ', '') as TiposEncamOdonto,
				STUFF((SELECT ','+CAST(nuasfs AS NVARCHAR(MAX)) FROM 
					SIGSM_Atendimento_Odontologico_Paciente u
					CROSS APPLY (
						VALUES
						(CASE WHEN ( escova_dental = 1 ) THEN 1 END),
						(CASE WHEN ( creme_dental = 1 ) THEN 2 END),
						(CASE WHEN ( fio_dental = 1 ) THEN 3 END)
					) c ([nuasfs])
					WHERE u.id = pac.id
				FOR XML PATH(''), TYPE).value('.', 'nvarchar(max)'), 1, 1, '') AS TiposFornecimOdonto,
                REPLACE(LTRIM(RTRIM(pac.vigilancia_saude_bucal)), ' ', '') as TiposVigilanciaSaudeBucal,
                REPLACE(LTRIM(RTRIM(CAST(pac.tipo_consulta AS VARCHAR))), ' ', '') AS TiposConsultaOdonto,
                sex.codigo AS Sexo,
                tur.id AS Turno
            from SIGSM_Atendimento_Odontologico_Paciente pac
				inner join SIGSM_Atendimento_Odontologico odo  on ( pac.id_atendimento_odontologico = odo.id and pac.NumContrato = odo.num_contrato )
                inner join ASSMED_Cadastro cad                 on ( pac.id_identificacao_usuario = cad.Codigo and pac.NumContrato = cad.NumContrato )
                inner join ASSMED_CadastroDocPessoal dpe       on ( dpe.NumContrato = cad.NumContrato )
                                                             and ( dpe.Codigo = cad.Codigo )
                                                             and ( dpe.CodTpDocP = 6 )
				left join TP_Sexo sex on pac.sexo = sex.sigla
				left join SIGSM_Turno tur on pac.turno = tur.sigla
GO
PRINT N'Altering [dbo].[VW_FichaAtividadeColetiva_ParticipanteRowItem]...';


GO

ALTER VIEW [dbo].[VW_FichaAtividadeColetiva_ParticipanteRowItem] AS
 select usu.id as Id,
		ati.guid_esus as UuidFicha,
        usu.numero_cartao_sus as CnsParticipante,
		usu.data_nascimento as DataNascimento,
        CAST(CASE usu.avaliacao_alterada WHEN 1 THEN 1 ELSE 0 END AS BIT) as AvaliacaoAlterada,
		usu.peso as Peso,
		usu.altura as Altura,
        CAST(CASE usu.tabagismo_cessou_habito_fumar WHEN 1 THEN 1 ELSE 0 END AS BIT) as CessouHabitoFumar, 
        CAST(CASE usu.tabagismo_abandonou_grupo WHEN 1 THEN 1 ELSE 0 END AS BIT) as AbandonouGrupo,
		sex.codigo AS Sexo
	from SIGSM_Atividade_Coletiva_Usuario usu
	    inner join SIGSM_Atividade_Coletiva ati on usu.id_atividade_coletiva = ati.id
		left join TP_Sexo sex on usu.sexo = sex.codigo
GO
PRINT N'Altering [dbo].[VW_FichaAtividadeColetiva_ProfissionalCboRowItem]...';


GO

ALTER VIEW [dbo].[VW_FichaAtividadeColetiva_ProfissionalCboRowItem] AS
 select ati.guid_esus as UuidFicha,
        pro.id as Id,
		dpe.Numero as Cns,
		RTRIM(LTRIM(pro.cbo)) as CodigoCbo2002
	from SIGSM_Atividade_Coletiva_Profissional_Saude pro
		left outer join SIGSM_Atividade_Coletiva ati on pro.id_atividade_coletiva = ati.id
		left outer join ASSMED_Cadastro cad on pro.id_profissional_saude = cad.Codigo
		left outer join ASSMED_CadastroDocPessoal dpe on dpe.NumContrato = cad.NumContrato AND dpe.Codigo = cad.Codigo AND dpe.CodTpDocP = 6
GO
PRINT N'Altering [dbo].[VW_FichaAvaliacaoElegibilidade_HeaderTransport]...';


GO

ALTER VIEW [dbo].[VW_FichaAvaliacaoElegibilidade_HeaderTransport] AS
 SELECT ava.id as Id,
        ava.guid_esus as UuidFicha,
        dpe.Numero as ProfissionalCNS,
        rtrim(ltrim(pro.cbo)) as CboCodigo_2002, 
        ava.codigo_cnes_unidade as Cnes,
        ava.codigo_equipe_ine as Ine,
        ava.data_avaliacao as DataAtendimento,
        ISNULL(pro.codibge_munic_nasc, ac.CodigoIbgeMunicipio) as CodigoIbgeMunicipio
   from SIGSM_Avaliacao_Elegibilidade_Admissao ava
            left outer join SIGSM_Avaliacao_Elegibilidade_Admissao_Profissional pro on pro.id_avaliacao = ava.id
            left outer join ASSMED_Cadastro cad on pro.id_profissional = cad.Codigo
            LEFT OUTER JOIN ASSMED_CadastroDocPessoal dpe on dpe.NumContrato = cad.NumContrato AND dpe.Codigo = cad.Codigo AND dpe.CodTpDocP = 6
		INNER JOIN ASSMED_Contratos ac ON ac.NumContrato = 22
GO
PRINT N'Altering [dbo].[VW_FichaConsumoAlimentar_UnicaLotacaoHeader]...';


GO

ALTER VIEW [dbo].[VW_FichaConsumoAlimentar_UnicaLotacaoHeader] AS
	 SELECT con.id AS Id,
            con.guid_esus AS UuidFicha,
            dpe.Numero AS ProfissionalCNS,
            rtrim(ltrim(con.cbo)) AS CboCodigo_2002,
            con.codigo_cnes_unidade AS Cnes,
            RTRIM(LTRIM(ine.Numero)) AS Ine,
            con.data_marcadores AS DataAtendimento,
            cont.CodigoIbgeMunicipio AS CodigoIbgeMunicipio
       FROM SIGSM_Marcadores_Consumo_Alimentar AS con
  LEFT JOIN ASSMED_Cadastro AS cad
		 ON con.id_profissional_saude = cad.Codigo	
 INNER JOIN ASSMED_Contratos AS cont
		 ON cont.NumContrato = 22
 INNER JOIN ASSMED_CadastroDocPessoal AS dpe
		 ON dpe.NumContrato = cad.NumContrato 
		AND dpe.Codigo = cad.Codigo
		AND dpe.CodTpDocP = 6
  LEFT JOIN SetoresINEs AS ine
		 ON ine.CodIne = con.codigo_equipe_ine
GO
PRINT N'Altering [dbo].[VW_FichaProcedimento_UnicaLotacaoHeader]...';


GO

ALTER VIEW [dbo].[VW_FichaProcedimento_UnicaLotacaoHeader] AS
	 select pro.guid_esus as UuidFicha,
	        dpe.Numero as ProfissionalCNS,
	        rtrim(ltrim(pro.cbo)) as CboCodigo_2002,
	        pro.codigo_cnes_unidade as Cnes,
	        sti.Numero as Ine,
	        pro.data_procedimento as DataAtendimento,
	        ISNULL(pro.codibge_munic_nasc, cont.CodigoIbgeMunicipio) as CodigoIbgeMunicipio
        from SIGSM_Procedimento pro
	   inner join ASSMED_Contratos AS cont ON cont.NumContrato = 22
        left join ASSMED_Cadastro cad           on ( pro.id_profissional_saude = cad.Codigo )
        left join ASSMED_CadastroDocPessoal dpe on ( dpe.NumContrato = cad.NumContrato ) 
                                                and ( dpe.Codigo = cad.Codigo ) 
									            and ( dpe.CodTpDocP = 6 )
        left join SetoresINEs sti               on ( pro.codigo_equipe_ine = sti.CodINE )
GO
PRINT N'Altering [dbo].[VW_FichaProcedimentoChild]...';


GO

ALTER VIEW [dbo].[VW_FichaProcedimentoChild] AS
	 select pro.guid_esus as UuidFicha,
            usu.numero_prontuario AS NumProntuario,
            (CASE LEN(RTRIM(LTRIM(usu.Numero_Cartao_Sus COLLATE Latin1_General_CI_AI))) WHEN 15 THEN RTRIM(LTRIM(usu.Numero_Cartao_Sus COLLATE Latin1_General_CI_AI)) ELSE NULL END) as CnsCidadao,
            usu.data_nascimento as DtNascimento,
            sex.codigo AS Sexo,
            usu.local_atendimento as LocalAtendimento,
            tur.id AS Turno,
            CAST(CASE
				WHEN usu.escuta_inicial_orientacao is null or usu.escuta_inicial_orientacao = 0 THEN 0
				ELSE 1
            END AS BIT) as StatusEscutaInicialOrientacao,
			STUFF((
			  select ',' + codigoab
				from sigsm_procedimento_usuario u   left join sigsm_procedimento pro        on ( u.id_procedimento = pro.id )
									                left join assmed_cadastro cad           on ( u.id_identificacao_usuario = cad.codigo )
									                left join assmed_cadastrodocpessoal dpe on ( dpe.numcontrato = cad.numcontrato ) 
									                                                        and ( dpe.codigo = cad.codigo ) 
																		                    and ( dpe.codtpdocp = 6 )
			cross apply (
				VALUES
                    (case u.acupuntura_com_insercao_de_agulhas WHEN 1 THEN 'ABPG001' --'ACUPUNTURA COM INSERÇÃO DE AGULHAS'
                    end),
					(case u.administracao_de_vitamina_a WHEN 1 THEN 'ABPG002' --'ADMINISTRAÇÃO DE VITAMINA A'
                    end),
					(case u.cateterismo_vesical_de_alivio WHEN 1 THEN 'ABPG003' --'CATETERISMO VESICAL DE ALIVIO'
                    end),
	                (case u.cauterizacao_quimica_de_pequenas_lesoes WHEN 1 THEN 'ABPG004' --'CAUTERIZAÇÃO QUIMICA DE PEQUENAS LESÕES'
                    end),
	                (case u.cirurgia_de_unha_cantoplastia WHEN 1 THEN 'ABPG005' --'CIRURGIA DE UNHA (CANTOPLASTIA)'
                    end),
	                (case u.cuidado_de_estomas WHEN 1 THEN 'ABPG006' --'CUIDADO DE ESTOMAS'
                    end),
	                (case u.curativo_especial WHEN 1 THEN 'ABPG007' --'CURATIVO ESPECIAL'
                    end),
	                (case u.drenagem_de_abscesso WHEN 1 THEN 'ABPG008' --'DRENAGEM DE ABSCESSO'
                    end),
	                (case u.eletrocardiograma WHEN 1 THEN 'ABEX004' --'ELETROCARDIOGRAMA'
                    end),
	                (case u.coleta_de_citopatologico_de_colo_uterino WHEN 1 THEN 'ABPG010' --'COLETA DE CITOPATOLOGICO DE COLO UTERINO'
                    end),
	                (case u.exame_do_pe_diabetico WHEN 1 THEN 'ABPG011' --'EXAME DO PÉ DIABÉTICO'
                    end),
	                (case u.exerese_biopsia_puncao_de_tumores_superficiais_de_pele WHEN 1 THEN 'ABPG012' --'EXÉRESE / BIÓPSIA / PUNÇÃO DE TUMORES SUPERFICIAIS DE PELE'
                    end),
	                (case u.fundoscopia_exame_de_fundo_de_olho WHEN 1 THEN 'ABPG013' --'FUNDOSCOPIA (EXAME DE FUNDO DE OLHO)'
                    end),
	                (case u.infiltracao_em_cavidade_sinovial WHEN 1 THEN 'ABPG014' --'INFILTRACÃO EM CAVIDADE SINOVIAL'
                    end),
	                (case u.remocao_de_corpo_estranho_da_cavidade_auditiva_e_nasal WHEN 1 THEN 'ABPG015' --'REMOÇÃO DE CORPO ESTRANHO DA CAVIDADE AUDITIVA E NASAL' -- Não fazia parte do select da MartTech
                    end),
    	            (case u.remocao_de_corpo_estranho_subcutaneo WHEN 1 THEN 'ABPG016'--'REMOÇÃO DE CORPO ESTRANHO SUBCUTÂNEO'
                    end),
	                (case u.retirada_de_cerume WHEN 1 THEN 'ABPG017' --'RETIRADA DE CERUME'
                    end),
	                (case u.retirada_de_pontos_de_cirurgias WHEN 1 THEN 'ABPG018' --'RETIRADA DE PONTOS DE CIRURGIAS'
                    end),
	                (case u.sutura_simples WHEN 1 THEN 'ABPG019' --'SUTURA SIMPLES'
                    end),
	                (case u.triagem_oftalmologica WHEN 1 THEN 'ABPG020' --'TRIAGEM OFTALMOLÓGICA'
                    end),
	                (case u.tamponamento_de_epistaxe WHEN 1 THEN 'ABPG021' --'TAMPONAMENTO DE EPISTAXE'
                    end),
	                (case u.teste_rapido_de_gravides WHEN 1 THEN 'ABPG022' -- 'TESTE RÁPIDO DE GRAVIDES'
                    end),
	                (case u.teste_rapido_dosagem_de_proteinuria WHEN 1 THEN 'ABPG040' --'TESTE RÁPIDO DOSAGEM DE PROTEINURIA'
                    end),
	                (case u.teste_rapido_para_hiv WHEN 1 THEN 'ABPG024' -- 'TESTE RÁPIDO PARA HIV'
                    end),
	                (case u.teste_rapido_para_hepatite_c WHEN 1 THEN 'ABPG025' --'TESTE RÁPIDO PARA HEPATITE C'
                    end),
	                (case u.teste_rapido_para_sifilis WHEN 1 THEN 'ABPG026' --'TESTE RÁPIDO PARA SÍFILIS'
                    end),
	                (case u.admin_de_medicamentos_oral WHEN 1 THEN 'ABPG027' --'ADMINISTRAÇÃO DE MEDICAMENTOS VIA ORAL'
                    end),
	                (case u.admin_de_medicamentos_intramuscular WHEN 1 THEN 'ABPG028' --'ADMINISTRAÇÃO DE MEDICAMENTOS VIA INTRAMUSCULAR'
                    end),
	                (case u.admin_de_medicamentos_endovenosa WHEN 1 THEN 'ABPG029' --'ADMINISTRAÇÃO DE MEDICAMENTOS VIA ENDOVENOSA'
                    end),
	                (case u.admin_de_medicamentos_inalacao_nebulizacao WHEN 1 THEN 'ABPG030' --'ADMINISTRAÇÃO DE MEDICAMENTOS VIA INALAÇÃO / NEBULIZAÇÃO'
                    end),
	                (case u.admin_de_medicamentos_topica WHEN 1 THEN 'ABPG031' --'ADMINISTRAÇÃO DE MEDICAMENTOS VIA TÓPICA'
                    end),
	                (case u.admin_de_medicamentos_penicilina_para_tratamento_de_sifilis WHEN 1 THEN 'ABPG032' --'ADMINISTRAÇÃO DE PENICILINA PARA TRATAMENTO DE SÍFILIS'
                    end)
				) c (codigoab)
                where u.id = usu.id and c.codigoab is not null
				FOR XML PATH(''), TYPE
			).value('.', 'nvarchar(max)'), 1, 1, '') AS LstProcedimentos,
			STUFF((select distinct ',' + rtrim(ltrim(tproc.CodProcTab))
                     from SIGSM_Procedimento sigsmProc left join SIGSM_Procedimento_Sigtap sigtap on (sigsmProc.id = sigtap.id_procedimento)
                                                       left join AS_Procedimentos procedimento    on (procedimento.CodProc = sigtap.CodProc )
								                       left join AS_TabelaProc tproc              on (procedimento.CodProc = tproc.CodProc )
                    where sigsmProc.guid_esus = pro.guid_esus and sigsmProc.id_status = 2 and len(rtrim(ltrim(ISNULL(tproc.CodProcTab, '')))) > 0
					FOR XML PATH(''), TYPE
			).value('.', 'nvarchar(max)'), 1, 1, '') AS LstOutrosSiaProcedimentos,
			usu.id AS Id
    from SIGSM_Procedimento_Usuario usu left join SIGSM_Procedimento pro        on ( usu.id_procedimento = pro.id )
                                        left join ASSMED_Cadastro cad           on ( usu.id_identificacao_usuario = cad.Codigo )
                                        left join ASSMED_CadastroDocPessoal dpe on ( dpe.NumContrato = cad.NumContrato ) 
                                                                                and ( dpe.Codigo = cad.Codigo ) 
                                                                                and ( dpe.CodTpDocP = 6 )	
										left join TP_Sexo sex					on usu.sexo = sex.sigla
										left join SIGSM_Turno tur				on usu.turno = tur.sigla
GO
PRINT N'Refreshing [dbo].[VW_INDIVIDUAIS]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_INDIVIDUAIS]';


GO
PRINT N'Refreshing [dbo].[VW_MARCADORES_CONSUMO_ALIMENTAR]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_MARCADORES_CONSUMO_ALIMENTAR]';


GO
PRINT N'Refreshing [dbo].[VW_PROCEDIMENTO]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_PROCEDIMENTO]';


GO
PRINT N'Refreshing [dbo].[Vw_Relatorios_AtendimentoCredenciado]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Vw_Relatorios_AtendimentoCredenciado]';


GO
PRINT N'Refreshing [dbo].[Vw_Relatorios_BPA]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Vw_Relatorios_BPA]';


GO
PRINT N'Refreshing [dbo].[VW_VISITA_DOMICILIAR]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_VISITA_DOMICILIAR]';


GO
PRINT N'Refreshing [dbo].[VW_ConsultaCadastrosDomiciliares]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_ConsultaCadastrosDomiciliares]';


GO
PRINT N'Altering [dbo].[VW_FichaAvaliacaoElegibilidade]...';


GO

ALTER VIEW [dbo].[VW_FichaAvaliacaoElegibilidade] AS
 SELECT ava.id as Id,
        ava.guid_esus as UuidFicha,
        3 as TpCdsOrigem,
        (CASE LEN(RTRIM(LTRIM(pac.numero_cartao_sus COLLATE Latin1_GENERAL_CI_AI))) WHEN 15 THEN RTRIM(LTRIM(pac.numero_cartao_sus COLLATE Latin1_GENERAL_CI_AI)) ELSE NULL END) as CnsCidadao,
        (CASE WHEN LEN(LTRIM(RTRIM(pac.nome_completo))) < 3 THEN NULL ELSE pac.nome_completo END) as NomeCidadao,
        (CASE WHEN LEN(LTRIM(RTRIM(pac.nome_social))) < 3 THEN NULL ELSE pac.nome_social END) as NomeSocialCidadao,
        pac.data_nascimento as DataNascimentoCidadao,
        sex.sigla AS SexoCidadao,
        pac.raca as RacaCorCidadao,
		(CASE WHEN LEN(ISNULL(LTRIM(RTRIM(pac.nome_completo_mae)), '')) < 3 THEN NULL ELSE pac.nome_completo_mae END) AS nomeMaeCidadao,
        CAST(CASE WHEN LEN(ISNULL(LTRIM(RTRIM(pac.nome_completo_mae)), '')) < 3 THEN 1 ELSE 0 END AS BIT) DesconheceNomeMae,
        pro.codibge_munic_nasc as CodigoIbgeMunicipioNascimento,
        pac.nacionalidade AS nacionalidadeCidadao,
        (CASE LEN(LTRIM(RTRIM(pac.email))) WHEN 0 THEN NULL ELSE pac.email END) as EmailCidadao,
        (CASE LEN(LTRIM(RTRIM(pac.nis))) WHEN 0 THEN NULL ELSE pac.nis END) as NumeroNisPisPasep,
        pac.origem as AtencaoDomiciliarProcedencia,
        pac.conclusao as AtencaoDomiciliarModalidade,
		dbo.FN_ParseCondicoesAvaliadas(pac.condicoes_avaliadas) AS LstCondicoesAvaliadas,
		(CASE LEN(LTRIM(RTRIM(pac.cid_1))) WHEN 0 THEN NULL ELSE pac.cid_1 END) as Cid10Principal,
        (CASE LEN(LTRIM(RTRIM(pac.cid_2))) WHEN 0 THEN NULL ELSE pac.cid_2 END) as Cid10SecundarioUm,
        (CASE LEN(LTRIM(RTRIM(pac.cid_3))) WHEN 0 THEN NULL ELSE pac.cid_3 END) as Cid10SecundarioDois,
        pac.conclusao_elegivel as ConclusaoDestinoElegivel,
        pac.conclusao_inelegivel as LstConclusaoDestinoInelegivel,
        (CASE WHEN pac.cuidador BETWEEN 1 AND 8 THEN pac.cuidador ELSE NULL END) as CuidadorCidadao,
		pac.turno AS Turno,
		(CASE WHEN LEN(ISNULL(LTRIM(RTRIM(pac.nome_completo_pai)), '')) < 3 THEN NULL ELSE pac.nome_completo_pai END) AS NomePaiCidadao,
        CAST(CASE WHEN LEN(ISNULL(LTRIM(RTRIM(pac.nome_completo_pai)), '')) < 3 THEN 1 ELSE 0 END AS BIT) DesconheceNomePai,
		pac.NAC_NAT_DATA AS DtNaturalizacao,
		pac.NAC_NAT_PORTARIA AS PortariaNaturalizacao,
		pac.NAC_EST_DATA AS DtEntradaBrasil,
		(CASE pac.nacionalidade WHEN 1 THEN ISNULL(pac.NAC_EST_PAIS, 31) WHEN 2 THEN NULL ELSE pac.NAC_EST_PAIS END) AS PaisNascimento,
		pac.ETNIA AS Etnia,
		(CASE LEN(RTRIM(LTRIM(pac.CNS_CUIDADOR))) WHEN 15 THEN RTRIM(LTRIM(pac.CNS_CUIDADOR)) ELSE NULL END) AS CnsCuidador,
		ava.data_avaliacao AS DataAvaliacao,
		ava.data_avaliacao AS DataAtendimento,
        CAST(CASE ava.enviado WHEN 1 THEN 1 ELSE 0 END AS BIT)  as Enviado,
		(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
		CAST(ava.codigo_cnes_unidade AS CHAR(7)) AS CNES
    FROM SIGSM_Avaliacao_Elegibilidade_Admissao ava
            Left Outer Join SIGSM_Avaliacao_Elegibilidade_Admissao_Paciente pac on ava.id = pac.id_avaliacao
            Left Outer Join SIGSM_Avaliacao_Elegibilidade_Admissao_Profissional pro on pro.id_avaliacao = ava.id
			left join TP_Sexo sex on pac.sexo = sex.sigla or pac.sexo = sex.codigo
			INNER JOIN ASSMED_Cadastro b on b.Codigo =  pac.id_paciente AND b.NumContrato = pac.num_contrato
			INNER JOIN ASSMED_CadastroDocPessoal c on c.NumContrato = b.NumContrato AND c.Codigo = b.Codigo AND c.CodTpDocP = 6
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = ava.guid_esus
    where ISNULL(enviado, 0) = 0 and id_status = 2
	AND LEN(RTRIM(LTRIM(ISNULL(ava.guid_esus, '')))) = 36
    AND 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'AvaliacaoElegibilidade')
GO
PRINT N'Altering [dbo].[VW_FichaAvaliacaoElegibilidade_EnderecoLocalPermanencia]...';


GO

ALTER VIEW [dbo].[VW_FichaAvaliacaoElegibilidade_EnderecoLocalPermanencia] AS
 SELECT ava.guid_esus as UuidFicha,
	    ava.id as Id,
        pac.bairro as Bairro,
        CAST(RTRIM(LTRIM(REPLACE(pac.cep, '-', ''))) AS CHAR(8)) as Cep,
        ISNULL(pro.codibge_munic_nasc, ac.CodigoIbgeMunicipio) as CodigoIbgeMunicipio,
        (CASE LEN(RTRIM(LTRIM(pac.complemento))) WHEN 0 THEN NULL ELSE RTRIM(LTRIM(pac.complemento)) END) as Complemento,
        pac.nome_logradouro as NomeLogradouro,
        pac.numero as Numero,
        pac.uf as NumeroDneUf,
        (CASE LEN(RTRIM(LTRIM(pac.telefone_referencia))) WHEN 0 THEN NULL ELSE RTRIM(LTRIM(pac.telefone_referencia)) END) as TelefoneContato,
        (CASE LEN(RTRIM(LTRIM(pac.telefone_residencial))) WHEN 0 THEN NULL ELSE RTRIM(LTRIM(pac.telefone_residencial)) END) as TelefoneResidencia,
        pac.tipo_logradouro as TipoLogradouroNumeroDne,
		CAST(CASE LEN(ISNULL(RTRIM(LTRIM(pac.numero)), '')) WHEN 0 THEN 1 ELSE 0 END AS BIT) AS StSemNumero,
		pac.PontoReferencia AS PontoReferencia
    FROM SIGSM_Avaliacao_Elegibilidade_Admissao_Paciente pac
        Left Outer Join SIGSM_Avaliacao_Elegibilidade_Admissao_Profissional pro on pro.id_avaliacao = pac.id
        Left Outer Join SIGSM_Avaliacao_Elegibilidade_Admissao ava on pac.id_avaliacao = ava.id
		INNER JOIN ASSMED_Contratos ac ON ac.NumContrato = 22
GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoDomiciliarMaster]...';


GO

ALTER VIEW [dbo].[VW_FichaAtendimentoDomiciliarMaster] AS
 select a.id as Id,
        3 as TpCdsOrigem,
        guid_esus as UuidFicha,
		CAST((CASE enviado WHEN 1 THEN 1 ELSE 0 END) AS BIT) as Enviado,
		data_atendimento AS DataAtendimento,
		(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
		CAST(a.codigo_cnes_unidade AS CHAR(7)) AS CNES
    from SIGSM_Atendimento_Domiciliar a
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = a.guid_esus
    where ISNULL(enviado, 0) = 0 and id_status = 2
	  AND 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'AtendimentoDomiciliar')
	  AND LEN(RTRIM(LTRIM(ISNULL(guid_esus, '')))) = 36
GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoIndividual_OutrosSia]...';


GO

ALTER VIEW [dbo].[VW_FichaAtendimentoIndividual_OutrosSia] AS
	select distinct ate.id as IdAtendimento,
	                ate.guid_esus as UuidFicha,
	                exame.id_atendimento_usuario as IdPaciente,
	                tb.CodProcTab as CodigoExame,
	                LTRIM(RTRIM(p.DesProc)) as Nome,
	                CASE WHEN LTRIM(RTRIM(exame.solicitado)) = 'S' THEN 'S'
					     WHEN LTRIM(RTRIM(exame.avaliado)) = 'A' THEN 'A'
						 ELSE NULL END as solicitadoAvaliado
                from
	                AE_Tabelas t left join AS_TabelaProc tb on ( t.NumContrato = tb.NumContrato )
	                                                        and ( t.CodTab = tb.CodTab )
				                    left join AS_Procedimentos p    on ( p.NumContrato = tb.NumContrato )
				                                                    and ( p.CodProc = tb.CodProc )
				                    left join Atendimento_Individual_Exames exame on ( rtrim(ltrim(p.DesProc)) = rtrim(ltrim(exame.descricao) COLLATE Latin1_General_CI_AI))
				                    left join Atendimento_Individual ate          on ( ate.id = exame.id_atendimento )
GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoIndividual_ProblemaCondicaoAvaliacaoAI]...';


GO

ALTER VIEW [dbo].[VW_FichaAtendimentoIndividual_ProblemaCondicaoAvaliacaoAI] AS
 select ate.id as IdAtendimentoIndividual,
        ate.guid_esus as UuidFicha, 
		STUFF((SELECT ','+ca.codigo FROM 
			Atendimento_Individual_Usuario u
			CROSS APPLY (
				VALUES
				(CASE WHEN ( asma = 1 ) THEN 1 END),
				(CASE WHEN ( dengue = 1 ) THEN 18 END),
				(CASE WHEN ( desnutricao = 1 ) THEN 2 END),
				(CASE WHEN ( diabetes = 1 ) THEN 3 END),
				(CASE WHEN ( dpoc = 1 ) THEN 4 END),
				(CASE WHEN ( dst = 1 ) THEN 19 END),
				(CASE WHEN ( hanseniase = 1 ) THEN 17 END),
				(CASE WHEN ( hipertensao_arterial = 1 ) THEN 5 END),
				(CASE WHEN ( obesidade = 1 ) THEN 6 END),
				(CASE WHEN ( pre_natal = 1 ) THEN 7 END),
				(CASE WHEN ( puericultura = 1 ) THEN 8 END),
				(CASE WHEN ( puerperio = 1 ) THEN 9 END),
				(CASE WHEN ( cancer_mama = 1 ) THEN 21 END),
				(CASE WHEN ( cancer_colo_utero = 1 ) THEN 20 END),
				(CASE WHEN ( risco_cardiovascular = 1 ) THEN 22 END),
				(CASE WHEN ( reabilitacao = 1 ) THEN 15 END),
				(CASE WHEN ( saude_mental = 1 ) THEN 14 END),
				(CASE WHEN ( saude_sexual_reprodutiva = 1 ) THEN 10 END),
				(CASE WHEN ( tabagismo = 1 ) THEN 11 END),
				(CASE WHEN ( tuberculose = 1 ) THEN 16 END),
				(CASE WHEN ( usuario_alcool = 1 ) THEN 12 END),
				(CASE WHEN ( usuario_outras_drogas = 1 ) THEN 13 END)
			) c (condicoes)
			INNER JOIN TP_Condicao_Avaliada ca ON condicoes = ca.Id_tp_condicao_avaliada
			WHERE u.id = usu.id AND ca.codigo IS NOT NULL
			FOR XML PATH(''), TYPE).value('.', 'nvarchar(max)'), 1, 1, '') as condicoes,
        usu.id as IdPaciente, 
	    LTRIM(RTRIM(ciap1.CodCIAP)) as OutroCiap1,
	    LTRIM(RTRIM(ciap2.CodCIAP)) as OutroCiap2,
	    LTRIM(RTRIM(cid10_1.CodCID)) as Cid10_01,
	    LTRIM(RTRIM(cid10_2.CodCID)) as Cid10_02
    from 	
        Atendimento_Individual_Usuario usu left join Atendimento_Individual ate on (usu.id_atendimento_individual = ate.id )
		left join SIGSM_CIAP ciap1 on LTRIM(RTRIM(ciap1.CodCIAP)) = ciap2_01
		left join SIGSM_CIAP ciap2 on LTRIM(RTRIM(ciap2.CodCIAP)) = ciap2_01
		left join AS_CID10 cid10_1 on LTRIM(RTRIM(cid10_1.CodCID)) = cid10_01 COLLATE Latin1_General_CI_AI
		left join AS_CID10 cid10_2 on LTRIM(RTRIM(cid10_2.CodCID)) = cid10_02 COLLATE Latin1_General_CI_AI
GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoIndividualMaster]...';


GO

ALTER VIEW [dbo].[VW_FichaAtendimentoIndividualMaster] AS
 select a.id as Id,
        guid_esus as UuidFicha,
        3 as TpCdsOrigem,
        data_atendimento as DataAtendimento,
        CAST(CASE enviado WHEN 1 THEN 1 ELSE 0 END AS BIT) as Enviado,
		(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
		CAST(a.codigo_cnes_unidade AS CHAR(7)) AS CNES
    from Atendimento_Individual a
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = a.guid_esus
    where  ISNULL(enviado, 0) = 0 and id_status = 2
	  AND 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'AtendimentoIndividual')
	  AND LEN(RTRIM(LTRIM(ISNULL(guid_esus, '')))) = 36
GO
PRINT N'Altering [dbo].[VW_FichaAtendimentoOdontologicoMaster]...';


GO

ALTER VIEW [dbo].[VW_FichaAtendimentoOdontologicoMaster] AS
select distinct A.id as ID,
                guid_esus as UuidFicha,
                3 as TpCdsOrigem,
                CAST(CASE enviado WHEN 1 THEN 1 ELSE 0 END AS BIT) as Enviado,
				data_atendimento AS DataAtendimento,
		(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
		CAST(A.codigo_cnes_unidade AS CHAR(7)) AS CNES
            from SIGSM_Atendimento_Odontologico A
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = A.guid_esus
            where ISNULL(enviado, 0) = 0 and id_status = 2
			  AND 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'AtendimentoOdontologico')
			  AND LEN(RTRIM(LTRIM(ISNULL(guid_esus, '')))) = 36
GO
PRINT N'Altering [dbo].[VW_FichaAtividadeColetiva]...';


GO

ALTER VIEW [dbo].[VW_FichaAtividadeColetiva] AS
 select ati.id as Id,
	    ati.guid_esus as UuidFicha,
	    ati.data_de_atividade as DtAtividadeColetiva,
	    ati.data_de_atividade as DataAtendimento,
	    (CASE LEN(RTRIM(LTRIM(ISNULL(ati.local_de_atividades, '')))) WHEN 0 THEN NULL ELSE RTRIM(LTRIM(ISNULL(ati.local_de_atividades, ''))) END) as OutraLocalidade,
	    (CASE WHEN LEN(RTRIM(LTRIM(ISNULL(ati.local_de_atividades, '')))) = 0 THEN
			(CASE ISNULL(ati.numero_inep_escola_creche, 0) WHEN 0 THEN NULL ELSE ati.numero_inep_escola_creche END)
		ELSE NULL END) as Inep,
	    (CASE WHEN ISNULL(ati.numero_de_participantes, 0) < (SELECT COUNT(*) FROM VW_FichaAtividadeColetiva_ParticipanteRowItem ri
			  WHERE ri.UuidFicha = ati.guid_esus) THEN (SELECT COUNT(*) FROM VW_FichaAtividadeColetiva_ParticipanteRowItem ri
			  WHERE ri.UuidFicha = ati.guid_esus) ELSE ati.numero_de_participantes END) as NumParticipantes,
	    (SELECT COUNT(*) FROM VW_FichaAtividadeColetiva_ParticipanteRowItem ri
			  WHERE ri.UuidFicha = ati.guid_esus
				AND ri.AvaliacaoAlterada = 1) as NumAvaliacoesAlteradas,
		ati.id_acao_estruturante_atividade, ati.id_acao_saude_atividade,
	    ISNULL(ati.id_acao_estruturante_atividade, ati.id_acao_saude_atividade) as AtividadeTipo,
		STUFF((SELECT ',' + CAST(id_temas_reuniao AS NVARCHAR(18))
                 FROM SIGSM_Atividade_Coletiva_Temas_Reuniao
                WHERE id_atividade_coletiva  = ati.id
				  FOR XML PATH(''), TYPE
		).value('.', 'nvarchar(max)'), 1, 1, '') AS LstTemasParaReuniao,
		STUFF((SELECT  ',' + CAST(id_acao_saude_publico_alvo AS NVARCHAR(18))
                 FROM SIGSM_Atividade_Coletiva_Publico_Alvo
	            WHERE id_atividade_coletiva = ati.id
				  FOR XML PATH(''), TYPE
		).value('.', 'nvarchar(max)'), 1, 1, '') AS LstPublico,
        3 as TbCdsOrigem,
		(CASE WHEN LEN(RTRIM(LTRIM(ISNULL(ati.local_de_atividades, '')))) = 0 THEN
			(CASE ISNULL(ati.numero_inep_escola_creche, 0) WHEN 0 THEN
				(CASE ISNULL(ati.CodigoCnesUnidadeAtividade, 0) WHEN 0 THEN NULL ELSE ati.CodigoCnesUnidadeAtividade END)
			ELSE NULL END)
		ELSE NULL END) as CnesLocalAtividade,
		ati.procedimento,
		ati.turno AS turno,
		STUFF((SELECT ',' + CAST(pt.id_praticas_temas_para_saude AS NVARCHAR(18))
                 FROM SIGSM_Atividade_Coletiva_Praticas_Temas_Para_Saude pt
		   INNER JOIN SIGSM_Praticas_Temas_Para_Saude pts
				   ON pt.id_praticas_temas_para_saude = pts.id
                WHERE id_atividade_coletiva  = ati.id AND pts.tipo = 'P'
				  FOR XML PATH(''), TYPE
		).value('.', 'nvarchar(max)'), 1, 1, '') AS LstPraticasSaude,
		ISNULL(
		STUFF((SELECT ',' + CAST(pt.id_praticas_temas_para_saude AS NVARCHAR(18))
                 FROM SIGSM_Atividade_Coletiva_Praticas_Temas_Para_Saude pt
		   INNER JOIN SIGSM_Praticas_Temas_Para_Saude pts
				   ON pt.id_praticas_temas_para_saude = pts.id
                WHERE id_atividade_coletiva  = ati.id AND pts.tipo = 'T'
				  FOR XML PATH(''), TYPE
		).value('.', 'nvarchar(max)'), 1, 1, ''),
		(CASE WHEN ISNULL(ati.id_acao_estruturante_atividade, ati.id_acao_saude_atividade) NOT IN (1, 2, 3, 4, 7) THEN '21' ELSE NULL END)) AS LstTemasSaude,
        CAST(CASE ati.enviado WHEN 1 THEN 1 ELSE 0 END AS BIT) as Enviado,
		(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
		CAST(ati.codigo_cnes_unidade AS CHAR(7)) AS CNES
    from SIGSM_Atividade_Coletiva ati
	left join SetoresINEs sine on ati.codigo_equipe_ine_do_responsavel = sine.CodINE
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = ati.guid_esus
    where ati.id_status = 2 and ISNULL(enviado, 0) = 0
	  AND 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'AtividadeColetiva')
	  AND LEN(RTRIM(LTRIM(ISNULL(ati.guid_esus, '')))) = 36
GO
PRINT N'Altering [dbo].[VW_FichaAtividadeColetiva_HeaderTransport]...';


GO

ALTER VIEW [dbo].[VW_FichaAtividadeColetiva_HeaderTransport] AS
 select ati.id as Id,
	    ati.guid_esus as UuidFicha,
		ati.numero_cartao_sus_do_responsavel AS ProfissionalCNS,
		(SELECT TOP(1) pro.cbo FROM SIGSM_Atividade_Coletiva_Profissional_Saude pro WHERE
			pro.id_atividade_coletiva = ati.id and (pro.id_profissional_saude = ati.id_responsavel or pro.cbo is not null)) as CboCodigo_2002,
	    ati.codigo_cnes_unidade_do_responsavel as Cnes,
	    (CASE LEN(RTRIM(LTRIM(COALESCE(sine.Numero, '')))) WHEN 0 THEN NULL ELSE RTRIM(LTRIM(COALESCE(sine.Numero, ''))) END) as Ine,
	    ati.data_de_atividade as DataAtendimento,
		ac.CodigoIbgeMunicipio as CodigoIbgeMunicipio
    from 
        SIGSM_Atividade_Coletiva ati
		left join SetoresINEs sine on ati.codigo_equipe_ine_do_responsavel = sine.CodINE
		INNER JOIN ASSMED_Contratos ac ON ac.NumContrato = 22
GO
PRINT N'Altering [dbo].[VW_FichaComplementar]...';


GO

ALTER VIEW [dbo].[VW_FichaComplementar] AS
	 SELECT c.uuidFicha AS UuidFicha,
			3 AS TpCdsOrigem,
			c.turno AS Turno,
			c.cnsCidadao AS CnsCidadao,
			c.cnsResponsavelFamiliar AS CnsResponsavelFamiliar,
			c.dataRealizacaoTesteOlhinho AS DataRealizacaoTesteOlhinho,
			c.coResultadoTesteOlhinho AS CoResultadoTesteOlhinho,
			c.dataRealizacaoExameFundoOlho AS DataRealizacaoExameFundoOlho,
			c.coResultadoExameFundoOlho AS CoResultadoExameFundoOlho,
			c.dataRealizacaoTesteOrelhinha AS DataRealizacaoTesteOrelhinha,
			c.coResultadoTesteOrelhinha AS CoResultadoTesteOrelhinha,
			c.dataRealizacaoUSTransfontanela AS DataRealizacaoUSTransfontanela,
			c.coResultadoUSTransfontanela AS CoResultadoUSTransfontanela,
			c.dataRealizacaoTomografiaComputadorizada AS DataRealizacaoTomografiaComputadorizada,
			c.coResultadoTomografiaComputadorizada AS CoResultadoTomografiaComputadorizada,
			c.dataRealizacaoRessonanciaMagnetica AS DataRealizacaoRessonanciaMagnetica,
			c.coResultadoRessonanciaMagnetica AS CoResultadoRessonanciaMagnetica,
			c.dataAtendimento AS DataAtendimento,
			(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
			CAST(c.cnes AS CHAR(7)) AS CNES
	   FROM SIGSM_ComplementarZika AS c
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = c.uuidFicha
	  WHERE ISNULL(enviado, 0) = 0 AND c.finalizado = 1
		AND 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'Complementar')
GO
PRINT N'Altering [dbo].[VW_FichaComplementar_UnicaLotacaoHeader]...';


GO

ALTER VIEW [dbo].[VW_FichaComplementar_UnicaLotacaoHeader] AS
	 SELECT c.uuidFicha AS UuidFicha,
			c.profissionalCns AS ProfissionalCns,
			c.cnes AS Cnes,
			c.codigoIbgeMunicipio AS CodigoIbgeMunicipio,
			c.ine AS Ine,
			c.cboCodigo_2002 AS CboCodigo_2002,
			c.dataAtendimento AS DataAtendimento
	   FROM SIGSM_ComplementarZika AS c
GO
PRINT N'Altering [dbo].[VW_FichaConsumoAlimentar]...';


GO

ALTER VIEW [dbo].[VW_FichaConsumoAlimentar] AS
select con.id as Id,
        con.guid_esus as UuidFicha,
        (CASE LEN(LTRIM(RTRIM(ISNULL(con.numero_cartao_sus_usuario, '')))) WHEN 0 THEN NULL ELSE LTRIM(RTRIM(con.numero_cartao_sus_usuario)) END) as CnsCidadao,
        con.nome as IdentificacaoUsuario,
        con.data_nascimento as DataNascimento,
        sex.codigo AS Sexo,
        con.local_atendimento as LocalAtendimento,
        3 as TpCdsOrigem,
        CAST(CASE con.enviado WHEN 1 THEN 1 ELSE 0 END AS BIT) AS Enviado,
		con.data_marcadores AS DataAtendimento,
		(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
		CAST(con.codigo_cnes_unidade AS CHAR(7)) AS CNES
	FROM SIGSM_Marcadores_Consumo_Alimentar AS con
LEFT JOIN TP_Sexo AS sex ON con.sexo = sex.sigla
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = con.guid_esus
	WHERE 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'ConsumoAlimentar')
	AND LEN(RTRIM(LTRIM(ISNULL(con.guid_esus, '')))) = 36
	AND id_status = 2
	AND ISNULL(enviado, 0) = 0
GO
PRINT N'Altering [dbo].[VW_FichaConsumoAlimentar_PerguntaQuestionarioCriancasComMaisDoisAnos]...';


GO


ALTER VIEW [dbo].[VW_FichaConsumoAlimentar_PerguntaQuestionarioCriancasComMaisDoisAnos] AS
	 SELECT mca.id AS FichaId, [Pergunta], [RespostaUnicaEscolha]
	   FROM [SIGSM_Crianca_Mais_2_Anos_Adolescente_Adulto_Gestante_Idoso] AS cmsm
 INNER JOIN SIGSM_Marcadores_Consumo_Alimentar AS mca
		 ON cmsm.id = mca.id_crianca_mais_2_anos_adolescente_adulto_gestante_idoso
CROSS APPLY (
	 VALUES (11, CASE 
				WHEN Upper([refeicao_assistindo_tv_mexendo_no_pc_e_ou_celular]) = Upper('Sim') THEN '1'
				WHEN Upper([refeicao_assistindo_tv_mexendo_no_pc_e_ou_celular]) = Upper('Nao') THEN '2'
				WHEN Upper([refeicao_assistindo_tv_mexendo_no_pc_e_ou_celular]) = Upper('Nao Sabe') THEN '3'
            ELSE Null
            END),
            (12, replace(replace(replace(replace(replace(replace(replace(		
                Upper([quais_reficoes_voce_faz]), 'CAFÉ DA MANHÃ', '12'), 
                upper('Lanche da Manhã'), '13'), 
                upper('Almoço'), '14'),
                upper('Lanche da Tarde'), '15'),
                upper('Jantar'), '16'),
                upper('Ceia'), '17'), ' ', '')),
            (14, CASE 
				WHEN Upper([ontem_voce_consumiu_feijao]) = Upper('Sim') THEN '1'
				WHEN Upper([ontem_voce_consumiu_feijao]) = Upper('Nao') THEN '2'
				WHEN Upper([ontem_voce_consumiu_feijao]) = Upper('Nao Sabe') THEN '3'
            ELSE Null
            END),
            (15, CASE 
				WHEN Upper([ontem_voce_consumiu_frutas_frescas]) = Upper('Sim') THEN '1'
				WHEN Upper([ontem_voce_consumiu_frutas_frescas]) = Upper('Nao') THEN '2'
				WHEN Upper([ontem_voce_consumiu_frutas_frescas]) = Upper('Nao Sabe') THEN '3'
            ELSE Null
            END),
            (16, CASE 
				WHEN Upper([ontem_voce_consumiu_verduras_e_ou_legumes]) = Upper('Sim') THEN '1'
				WHEN Upper([ontem_voce_consumiu_verduras_e_ou_legumes]) = Upper('Nao') THEN '2'
				WHEN Upper([ontem_voce_consumiu_verduras_e_ou_legumes]) = Upper('Nao Sabe') THEN '3'
            ELSE Null
            END),
            (17, CASE 
				WHEN Upper([ontem_voce_consumiu_hamburguer_e_ou_embutidos]) = Upper('Sim') THEN '1'
				WHEN Upper([ontem_voce_consumiu_hamburguer_e_ou_embutidos]) = Upper('Nao') THEN '2'
				WHEN Upper([ontem_voce_consumiu_hamburguer_e_ou_embutidos]) = Upper('Nao Sabe') THEN '3'
            ELSE Null
            END),
            (18, CASE 
				WHEN Upper([ontem_voce_consumiu_bebidas_adocadas]) = Upper('Sim') THEN '1'
				WHEN Upper([ontem_voce_consumiu_bebidas_adocadas]) = Upper('Nao') THEN '2'
				WHEN Upper([ontem_voce_consumiu_bebidas_adocadas]) = Upper('Nao Sabe') THEN '3'
            ELSE Null
            END),
            (19, CASE 
				WHEN Upper([ontem_voce_consumiu_macarrao_instantaneo_salgadinhos_de_pacote_biscoitos_salgados]) = Upper('Sim') THEN '1'
				WHEN Upper([ontem_voce_consumiu_macarrao_instantaneo_salgadinhos_de_pacote_biscoitos_salgados]) = Upper('Nao') THEN '2'
				WHEN Upper([ontem_voce_consumiu_macarrao_instantaneo_salgadinhos_de_pacote_biscoitos_salgados]) = Upper('Nao Sabe') THEN '3'
            ELSE Null
            END),
            (20, CASE 
				WHEN Upper([ontem_voce_consumiu_biscoito_recheado_doces]) = Upper('Sim') THEN '1'
				WHEN Upper([ontem_voce_consumiu_biscoito_recheado_doces]) = Upper('Nao') THEN '2'
				WHEN Upper([ontem_voce_consumiu_biscoito_recheado_doces]) = Upper('Nao Sabe') THEN '3'
            ELSE Null
            END)
			) AS a ([Pergunta], [RespostaUnicaEscolha])
GO
PRINT N'Altering [dbo].[VW_FichaProcedimentoMaster]...';


GO

ALTER VIEW [dbo].[VW_FichaProcedimentoMaster] AS
select guid_esus as UuidFicha,
        3 as TpCdsOrigem,
        (CASE RTRIM(LTRIM(afericao_pa)) WHEN '0' THEN NULL ELSE afericao_pa END) as NumTotalAfericaoPa,
        (CASE RTRIM(LTRIM(glicemia_capilar)) WHEN '0' THEN NULL ELSE glicemia_capilar END) as NumTotalGlicemiaCapilar,
        (CASE RTRIM(LTRIM(afericao_temperatura)) WHEN '0' THEN NULL ELSE afericao_temperatura END) as NumTotalAfericaoTemperatura,
        (CASE RTRIM(LTRIM(medicao_altura)) WHEN '0' THEN NULL ELSE medicao_altura END) as NumTotalMedicaoAltura,
        (CASE RTRIM(LTRIM(curativo_simples)) WHEN '0' THEN NULL ELSE curativo_simples END) as NumTotalCurativoSimples,
        (CASE RTRIM(LTRIM(medicao_peso)) WHEN '0' THEN NULL ELSE medicao_peso END) as NumTotalMedicaoPeso,
        (CASE RTRIM(LTRIM(coleta_material)) WHEN '0' THEN NULL ELSE coleta_material END) as NumTotalColetaMaterialParaExameLaboratorial,
        CAST(CASE enviado WHEN 1 THEN 1 ELSE 0 END AS BIT) as Enviado,
		data_procedimento as DataAtendimento,
		(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
		CAST(a.codigo_cnes_unidade AS CHAR(7)) AS CNES
	FROM SIGSM_Procedimento a
	LEFT JOIN SIGSM_Transmissao_Processos procs ON CAST(procs.Id AS VARCHAR(36)) = a.guid_esus
	WHERE LEN(RTRIM(LTRIM(ISNULL(a.guid_esus, '')))) = 36
    AND 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'Procedimento')
	AND id_status = 2
	AND ISNULL(enviado, 0) = 0
GO
PRINT N'Altering [dbo].[VW_FichaVisitaDomiciliarTerritorial_UnicaLotacaoHeader]...';


GO

ALTER VIEW [dbo].[VW_FichaVisitaDomiciliarTerritorial_UnicaLotacaoHeader] AS
	 SELECT ficha.uuidFicha AS UuidFicha,
			header.cboCodigo_2002 AS CboCodigo_2002,
			header.cnes AS Cnes,
			header.codigoIbgeMunicipio AS CodigoIbgeMunicipio,
			header.dataAtendimento AS DataAtendimento,
			header.ine AS Ine,
			header.profissionalCNS AS ProfissionalCNS
	   FROM api.UnicaLotacaoTransport AS header
 INNER JOIN api.FichaVisitaDomiciliarMaster AS ficha
		 ON header.id = ficha.headerTransport
GO
PRINT N'Altering [dbo].[VW_FichaVisitaDomiciliarTerritorialMaster]...';


GO

ALTER VIEW [dbo].[VW_FichaVisitaDomiciliarTerritorialMaster] AS
	SELECT a.uuidFicha AS UuidFicha,
			3 AS TpCdsOrigem,
			f.dataAtendimento AS DataAtendimento,
		(CASE WHEN procs.Id IS NOT NULL THEN 1 ELSE 0 END) AS Agendado,
		f.cnes AS CNES
	FROM api.FichaVisitaDomiciliarMaster a
	JOIN api.UnicaLotacaoTransport f
			 ON a.headerTransport = f.Id
	JOIN api.OrigemVisita g
			 ON f.token = g.token
	LEFT JOIN SIGSM_Transmissao_Processos procs ON a.uuidFicha = f.cnes + CAST(procs.Id AS VARCHAR(36))
	WHERE 1 = (SELECT Gerar FROM SIGSM_ServicoSerializador_Fichas WHERE Ficha = 'VisitaDomiciliar')
		AND ISNULL(enviado, 0) = 0
		AND g.finalizado = 1
		AND g.enviarParaThrift = 1
GO
PRINT N'Creating [dbo].[VW_Cadastros_Zoneamento]...';


GO

CREATE VIEW [dbo].[VW_Cadastros_Zoneamento]
AS
	  SELECT c.Codigo,
			 e.ItemEnd,
			 c.IdFicha AS IdIdentificacaoUsuarioCidadao,
			 e.IdFicha AS IdEnderecoLocalPermanencia,
			 ISNULL(e.MicroArea, ISNULL(c.MicroArea, ISNULL(elp.microarea, iuc.microarea))) AS MicroArea
		FROM ASSMED_Cadastro c
 OUTER APPLY (SELECT MAX(es.ItemEnd) AS ItemEnd FROM ASSMED_Endereco es WHERE es.Codigo = c.Codigo) AS ends
   LEFT JOIN ASSMED_Endereco e
		  ON c.Codigo = e.Codigo
		 AND ends.ItemEnd = e.ItemEnd
   LEFT JOIN api.IdentificacaoUsuarioCidadao iuc
		  ON c.IdFicha = iuc.id
   LEFT JOIN api.EnderecoLocalPermanencia elp
		  ON e.IdFicha = elp.id
	   WHERE (c.IdFicha IS NULL
		  OR iuc.statusEhResponsavel = 1)
;
GO
PRINT N'Creating [dbo].[VW_TB_MS_TIPO_LOGRADOURO]...';


GO
CREATE VIEW VW_TB_MS_TIPO_LOGRADOURO AS
	 SELECT CAST(tb.CO_TIPO_LOGRADOURO AS INT) AS Id,
			tb.CO_TIPO_LOGRADOURO,
			tb.DS_TIPO_LOGRADOURO,
			tb.DS_TIPO_LOGRADOURO_ABREV
	  FROM TB_MS_TIPO_LOGRADOURO tb
GO
PRINT N'Creating [dbo].[VW_Vinculos]...';


GO

CREATE VIEW [dbo].[VW_Vinculos] AS
	  SELECT docsp.CNSProfissional COLLATE Latin1_General_CI_AI AS CNSProfissional,
			 UPPER(LTRIM(RTRIM(prof.Nome COLLATE Latin1_General_CI_AI))) as NomeProfissional,
			 UPPER(LTRIM(RTRIM(asp.CNES COLLATE Latin1_General_CI_AI))) AS CNES,
			 UPPER(LTRIM(RTRIM(se.DesSetor COLLATE Latin1_General_CI_AI))) AS Unidade,
			 c.Codigo,
			 docs.CNSCidadao COLLATE Latin1_General_CI_AI AS CNSCidadao,
			 UPPER(LTRIM(RTRIM(c.Nome COLLATE Latin1_General_CI_AI))) AS NomeCidadao,
			 sma.Codigo AS CodMicroArea,
			 sma.Descricao COLLATE Latin1_General_CI_AI AS MicroArea,
			 mcc.id AS Vinculo,
			 ac.CodCred,
			 tl.DS_TIPO_LOGRADOURO_ABREV COLLATE Latin1_General_CI_AI AS TpLog,
			 e.Logradouro COLLATE Latin1_General_CI_AI AS Logradouro,
			 e.Numero COLLATE Latin1_General_CI_AI AS Numero,
			 e.CEP COLLATE Latin1_General_CI_AI AS CEP,
			 e.Bairro COLLATE Latin1_General_CI_AI AS Bairro,
			 ROW_NUMBER() OVER (ORDER BY
				(CASE WHEN mcc.id IS NULL THEN 1 ELSE 0 END),
				(CASE WHEN ac.CodCred IS NULL THEN 1 ELSE 0 END),
				(CASE WHEN e.Logradouro IS NULL THEN 1 ELSE 0 END),
				UPPER(LTRIM(RTRIM(c.Nome COLLATE Latin1_General_CI_AI))),
				ac.CodCred, e.Logradouro) AS [row]
		FROM ASSMED_Cadastro AS c
 OUTER APPLY (SELECT TOP 1 LTRIM(RTRIM(dc.Numero)) AS CNSCidadao FROM ASSMED_CadastroDocPessoal dc WHERE dc.Codigo = c.Codigo AND dc.CodTpDocP = 6 AND LEN(LTRIM(RTRIM(ISNULL(dc.Numero, '')))) = 15) AS docs
 OUTER APPLY (SELECT MAX(es.ItemEnd) AS ItemEnd FROM ASSMED_Endereco es WHERE es.Codigo = c.Codigo) AS ends
   LEFT JOIN ASSMED_Endereco e
		  ON c.Codigo = e.Codigo
		 AND ends.ItemEnd = e.ItemEnd
   LEFT JOIN TB_MS_TIPO_LOGRADOURO tl
		  ON e.CodTpLogra = tl.CO_TIPO_LOGRADOURO
   LEFT JOIN api.IdentificacaoUsuarioCidadao iuc
		  ON c.IdFicha = iuc.id
   LEFT JOIN api.EnderecoLocalPermanencia elp
		  ON e.IdFicha = elp.id
   LEFT JOIN SIGSM_MicroAreas AS sma
		  ON ISNULL(c.MicroArea, ISNULL(elp.microarea, iuc.microarea)) = sma.Codigo
   LEFT JOIN SIGSM_MicroArea_Unidade smau
		  ON sma.Codigo = smau.MicroArea
   LEFT JOIN SIGSM_MicroArea_CredenciadoVinc mcv
		  ON smau.id = mcv.idMicroAreaUnidade
   LEFT JOIN SIGSM_MicroArea_CredenciadoCidadao mcc
		  ON c.Codigo = mcc.Codigo
		 AND mcc.idMaCredVinc = mcv.id
   LEFT JOIN AS_Credenciados ac
		  ON mcv.CodCred = ac.CodCred
   LEFT JOIN ASSMED_Cadastro prof
		  ON ac.Codigo = prof.Codigo
   LEFT JOIN Setores se
		  ON smau.CodSetor = se.CodSetor
   LEFT JOIN AS_SetoresPar asp
		  ON se.CodSetor = asp.CodSetor
 OUTER APPLY (SELECT TOP 1 LTRIM(RTRIM(dc.Numero)) AS CNSProfissional FROM ASSMED_CadastroDocPessoal dc WHERE dc.Codigo = prof.Codigo AND dc.CodTpDocP = 6 AND LEN(LTRIM(RTRIM(ISNULL(dc.Numero, '')))) = 15) AS docsp
	   WHERE (c.IdFicha IS NULL
		  OR iuc.statusEhResponsavel = 1) AND (ISNULL(e.MicroArea, ISNULL(c.MicroArea, ISNULL(elp.microarea, iuc.microarea))) IS NULL
		  OR ISNULL(e.MicroArea, ISNULL(c.MicroArea, ISNULL(elp.microarea, iuc.microarea))) = sma.Codigo)
		 AND c.Tipo = 'F'
GO
PRINT N'Refreshing [api].[VW_VISITAS]...';


GO
EXECUTE sp_refreshsqlmodule N'[api].[VW_VISITAS]';


GO
PRINT N'Creating [dbo].[FN_CNSValido]...';


GO
-- =============================================
-- Author:		Elton Schivei Costa
-- Create date: 2017-12-01
-- Description:	Validador de CNS
-- =============================================
CREATE FUNCTION FN_CNSValido 
(
	-- Add the parameters for the function here
	@cns CHAR(15)
)
RETURNS BIT
AS
BEGIN
	DECLARE @soma DECIMAL(18,8) = 0,
			@resto DECIMAL(18,8),
			@dv DECIMAL(18,8),
			@size INT = 15,
			@pis VARCHAR(11),
			@for VARCHAR(15),
			@cont CHAR(3) = '000',
			@c INT;
	-- Declare the return variable here
	DECLARE @Result BIT

	-- Add the T-SQL statements to compute the return value here
	SET @pis = SUBSTRING(@cns, 1, 11);

	IF (SUBSTRING(@cns, 1, 1) IN ('1', '2'))
	BEGIN
		SET @for = @pis;

		WHILE(LEN(@for) > 0)
		BEGIN
			SET @c = CAST(SUBSTRING(@for, 1, 1) AS INT);
			SET @soma = @soma + (@c * @size);
			SET @size = @size - 1;
			SET @for = SUBSTRING(@for, 2, LEN(@for) - 1);
		END

		SET @resto = @soma % 11;
		SET @dv = 11 - @resto;
		
		IF (@dv = 11)
			SET @dv = 0;

		IF (@dv = 10)
		BEGIN
			SET @soma = @soma + 2;
			SET @resto = @soma % 11;
			SET @dv = 11 - @resto;

			SET @cont = '001';
		END

		SET @Result = (CASE (@pis + @cont + CAST(CAST(@dv AS INT) AS VARCHAR(1))) WHEN @cns THEN 1 ELSE 0 END);
	END
	ELSE
	IF (SUBSTRING(@cns, 1, 1) IN ('7', '8', '9'))
	BEGIN
		SELECT @for = @cns;

		WHILE(LEN(@for) > 0)
		BEGIN
			SET @c = CAST(SUBSTRING(@for, 1, 1) AS INT);
			SET @soma = @soma + (@c * @size);
			SET @size = @size - 1;
			SET @for = SUBSTRING(@for, 2, LEN(@for) - 1);
		END

		SET @resto = @soma % 11;

		SET @Result = (CASE @resto WHEN 0 THEN 1 ELSE 0 END);
	END

	-- Return the result of the function
	RETURN @Result
END
GO
PRINT N'Altering [dbo].[PR_ConsultaCadastroIndividuais]...';


GO

--*
--* Atualização para reduzir o workload de busca pelo Id da Ficha
--*

ALTER PROCEDURE [dbo].[PR_ConsultaCadastroIndividuais] (@search NVARCHAR(MAX), @skip INT, @take INT, @orderCol INT, @orderDirection INT, @total INT OUT, @totalFiltered INT OUT) AS

BEGIN
	SET NOCOUNT ON;
	SET LANGUAGE brazilian;

    declare @isNum BIT,
			@isGuid BIT,
			@isDate BIT,
			@isCns BIT,
			@len INT;

	declare @sDate DATETIME,
			@sCNS CHAR(15),
			@sCodigo DECIMAL(18, 0),
			@sGuid UNIQUEIDENTIFIER;

	DECLARE @skips int = @skip + 1;
	DECLARE @takes int = @skip + @take;
	DECLARE @column NVARCHAR(50);
	 SELECT @len = LEN(@search);

	 SELECT @isNum = ISNUMERIC(@search),
			@isGuid = (CASE WHEN @search LIKE REPLACE('00000000-0000-0000-0000-000000000000', '0', '[0-9a-fA-F]') THEN 1 ELSE 0 END),
			@isDate = ISDATE(@search),
			@isCns = (CASE WHEN @len = 15 AND ISNUMERIC(@search) = 1 AND SUBSTRING(@search, 1, 1) IN ('1', '2', '7', '8', '9') THEN 1 ELSE 0 END);

	 SELECT @totalFiltered = 100,
			@total = 100;

	 SELECT @sDate = (CASE @isDate WHEN 1 THEN @search ELSE NULL END),
			@sCns = (CASE @isCns WHEN 1 THEN @search ELSE NULL END),
			@sGuid = (CASE @isGuid WHEN 1 THEN @search ELSE NULL END),
			@sCodigo = (CASE WHEN (@isCns = 0 AND @isNum = 1) THEN CAST(@search AS decimal(18, 0)) ELSE NULL END);

	-- se o dado buscado for um Guid, o valor da busca é trocado pelo Codigo ASSMED_Cadastro correspondente, se existir
	IF (@isGuid = 1)
	BEGIN
		 SELECT @sCodigo = cads.Codigo,
				@isNum = 1,
				@search = CAST(cads.Codigo AS VARCHAR(20))
		   FROM ASSMED_Cadastro AS cads
	 INNER JOIN api.IdentificacaoUsuarioCidadao AS iden
			 ON cads.IdFicha = iden.id
			 OR cads.Codigo = iden.Codigo
	 INNER JOIN api.CadastroIndividual AS ci
			 ON iden.Id = ci.identificacaoUsuarioCidadao
		  WHERE ci.id = @sGuid
		 SELECT @isGuid = 0, @isCns = 0;
	END

	-- as duas queries abaixo são para aplicar a ordenação correta
	IF @orderDirection = 0
	BEGIN
	 SELECT DISTINCT * FROM (
	 SELECT TOP 100 PERCENT
			Nome,
			DtNasc,
			NomeMae,
			Cns,
			NomeCidade,
			Codigo
	   FROM (
	 SELECT ac.Nome COLLATE Latin1_General_CI_AI AS [Nome],
			CONVERT(CHAR, CAST(ISNULL(pf.DtNasc, pf2.DtNasc) AS DATE), 103) AS DtNasc,
			ISNULL(pf.NomeMae, pf2.NomeMae) COLLATE Latin1_General_CI_AI AS [NomeMae],
			SUBSTRING(LTRIM(RTRIM(cns.Numero)), 1, 15) COLLATE Latin1_General_CI_AI AS Cns,
			cid.NomeCidade COLLATE Latin1_General_CI_AI AS [NomeCidade],
			CAST(CAST(ac.Codigo AS INT) AS NVARCHAR(MAX)) AS Codigo,
			ROW_NUMBER() OVER (ORDER BY
			(CASE @orderCol WHEN 0 THEN ac.Nome COLLATE Latin1_General_CI_AI
					WHEN 1 THEN CONVERT(CHAR, ISNULL(pf.DtNasc, pf2.DtNasc), 126)
					WHEN 2 THEN ISNULL(pf.NomeMae, pf2.NomeMae) COLLATE Latin1_General_CI_AI
					WHEN 3 THEN cns.Numero COLLATE Latin1_General_CI_AI
					WHEN 4 THEN cid.NomeCidade COLLATE Latin1_General_CI_AI
					ELSE CAST(CAST(ac.Codigo AS BIGINT) AS NVARCHAR(30)) END) ASC, ac.Nome COLLATE Latin1_General_CI_AI ASC) AS _row
	   FROM ASSMED_Cadastro AS ac
  LEFT JOIN ASSMED_PesFisica AS pf
		 ON pf.Codigo = ac.Codigo
  LEFT JOIN ASSMED_CadastroPF AS pf2
		 ON pf2.Codigo = ac.Codigo
  LEFT JOIN ASSMED_CadastroDocPessoal AS cns
		 ON ac.Codigo = cns.Codigo
		AND cns.CodTpDocP = 6
  LEFT JOIN Cidade as cid
		 ON pf.MUNICIPIONASC = cid.CodCidade
		 OR pf2.MUNICIPIONASC = cid.CodCidade
	  WHERE ac.Nome IS NOT NULL
		AND LEN(RTRIM(LTRIM(ac.Nome COLLATE Latin1_General_CI_AI))) > 0
		AND ac.Nome COLLATE Latin1_General_CI_AI NOT LIKE '%*%'
		AND ((@len = 0 OR @search IS NULL) OR
			(@isCns = 1 AND cns.Numero COLLATE Latin1_General_CI_AI = @sCNS COLLATE Latin1_General_CI_AI) OR
			(@isCns = 0 AND @isNum = 1 AND ac.Codigo = @sCodigo) OR
			(@isDate = 1 AND ISNULL(pf.DtNasc, pf2.DtNasc) = @sDate) OR
			(@isCns = 1 AND cns.Numero COLLATE Latin1_General_CI_AI = @sCNS COLLATE Latin1_General_CI_AI) OR
			(@isCns = 0 AND @isGuid = 0 AND @isDate = 0 AND (
				cid.NomeCidade COLLATE Latin1_General_CI_AI LIKE '%' + @search + '%' OR
				ac.Nome COLLATE Latin1_General_CI_AI LIKE '%' + @search + '%' OR
				ISNULL(pf.NomeMae, pf2.NomeMae) COLLATE Latin1_General_CI_AI LIKE '%' + @search + '%'
			)))
		  ) AS _
	  WHERE _row BETWEEN @skips AND @takes
   ORDER BY _row) AS a;
	END
	ELSE
	BEGIN
	 SELECT DISTINCT * FROM (
	 SELECT TOP 100 PERCENT
			Nome,
			DtNasc,
			NomeMae,
			Cns,
			NomeCidade,
			Codigo
	   FROM (
	 SELECT ac.Nome COLLATE Latin1_General_CI_AI AS [Nome],
			CONVERT(CHAR, CAST(ISNULL(pf.DtNasc, pf2.DtNasc) AS DATE), 103) AS DtNasc,
			ISNULL(pf.NomeMae, pf2.NomeMae) COLLATE Latin1_General_CI_AI AS [NomeMae],
			SUBSTRING(LTRIM(RTRIM(cns.Numero)), 1, 15) COLLATE Latin1_General_CI_AI AS Cns,
			cid.NomeCidade COLLATE Latin1_General_CI_AI AS [NomeCidade],
			CAST(CAST(ac.Codigo AS INT) AS NVARCHAR(MAX)) AS Codigo,
			ROW_NUMBER() OVER (ORDER BY
			(CASE @orderCol WHEN 0 THEN ac.Nome COLLATE Latin1_General_CI_AI
					WHEN 1 THEN CONVERT(CHAR, ISNULL(pf.DtNasc, pf2.DtNasc), 126)
					WHEN 2 THEN ISNULL(pf.NomeMae, pf2.NomeMae) COLLATE Latin1_General_CI_AI
					WHEN 3 THEN cns.Numero COLLATE Latin1_General_CI_AI
					WHEN 4 THEN cid.NomeCidade COLLATE Latin1_General_CI_AI
					ELSE CAST(CAST(ac.Codigo AS BIGINT) AS NVARCHAR(30)) END) DESC, ac.Nome COLLATE Latin1_General_CI_AI DESC) AS _row
	   FROM ASSMED_Cadastro AS ac
  LEFT JOIN ASSMED_PesFisica AS pf
		 ON pf.Codigo = ac.Codigo
  LEFT JOIN ASSMED_CadastroPF AS pf2
		 ON pf2.Codigo = ac.Codigo
  LEFT JOIN ASSMED_CadastroDocPessoal AS cns
		 ON ac.Codigo = cns.Codigo
		AND cns.CodTpDocP = 6
  LEFT JOIN Cidade as cid
		 ON pf.MUNICIPIONASC = cid.CodCidade
		 OR pf2.MUNICIPIONASC = cid.CodCidade
	  WHERE ac.Nome IS NOT NULL
		AND LEN(RTRIM(LTRIM(ac.Nome COLLATE Latin1_General_CI_AI))) > 0
		AND ac.Nome COLLATE Latin1_General_CI_AI NOT LIKE '%*%'
		AND ((@len = 0 OR @search IS NULL) OR
			(@isCns = 1 AND cns.Numero COLLATE Latin1_General_CI_AI = @sCNS COLLATE Latin1_General_CI_AI) OR
			(@isCns = 0 AND @isNum = 1 AND ac.Codigo = @sCodigo) OR
			(@isDate = 1 AND ISNULL(pf.DtNasc, pf2.DtNasc) = @sDate) OR
			(@isCns = 1 AND cns.Numero COLLATE Latin1_General_CI_AI = @sCNS COLLATE Latin1_General_CI_AI) OR
			(@isCns = 0 AND @isGuid = 0 AND @isDate = 0 AND (
				cid.NomeCidade COLLATE Latin1_General_CI_AI LIKE '%' + @search + '%' OR
				ac.Nome COLLATE Latin1_General_CI_AI LIKE '%' + @search + '%' OR
				ISNULL(pf.NomeMae, pf2.NomeMae) COLLATE Latin1_General_CI_AI LIKE '%' + @search + '%'
			)))
		  ) AS _
	  WHERE _row BETWEEN @skips AND @takes
   ORDER BY _row) AS a;
	END
END
GO
PRINT N'Creating [dbo].[PR_RollbackGeracaoFichas]...';


GO

CREATE PROCEDURE PR_RollbackGeracaoFichas(@mes integer, @ano integer) AS
BEGIN
	update Atendimento_Individual set enviado = 0, id_status = 2
	from Atendimento_Individual f
	inner join SIGSM_Transmissao_Processos p
	on f.guid_esus = p.Id
	where year(data_atendimento)=@ano	and month(data_atendimento)=@mes

	update SIGSM_Atendimento_Odontologico set enviado = 0, id_status = 2
	from SIGSM_Atendimento_Odontologico f
	inner join SIGSM_Transmissao_Processos p
	on f.guid_esus = p.Id
	where year(data_atendimento)=@ano	and month(data_atendimento)=@mes

	update sigsm_procedimento set enviado = 0, id_status = 2
	from sigsm_procedimento f
	inner join SIGSM_Transmissao_Processos p
	on f.guid_esus = p.Id
	where year(data_procedimento)=@ano	and month(data_procedimento)=@mes

	update SIGSM_Atividade_Coletiva set enviado = 0, id_status = 2
	from SIGSM_Atividade_Coletiva f
	inner join SIGSM_Transmissao_Processos p
	on f.guid_esus = p.Id
	where year(data_de_atividade)=@ano	and month(data_de_atividade)=@mes

	update SIGSM_Marcadores_Consumo_Alimentar set enviado = 0, id_status = 2
	from SIGSM_Marcadores_Consumo_Alimentar f
	inner join SIGSM_Transmissao_Processos p
	on f.guid_esus = p.Id
	where year(data_marcadores)=@ano	and month(data_marcadores)=@mes

	update SIGSM_Atendimento_Domiciliar set enviado = 0, id_status = 2
	from SIGSM_Atendimento_Domiciliar f
	inner join SIGSM_Transmissao_Processos p
	on f.guid_esus = p.Id
	where year(data_atendimento)=@ano	and month(data_atendimento)=@mes

	update SIGSM_Avaliacao_Elegibilidade_Admissao set enviado = 0, id_status = 2
	from SIGSM_Avaliacao_Elegibilidade_Admissao f
	inner join SIGSM_Transmissao_Processos p
	on f.guid_esus = p.Id
	where year(data_avaliacao)=@ano	and month(data_avaliacao)=@mes

	update SIGSM_ComplementarZika set enviado = 0, finalizado = 1
	from SIGSM_ComplementarZika f
	inner join SIGSM_Transmissao_Processos p
	on f.uuidFicha = p.Id
	where year(dataAtendimento)=@ano	and month(dataAtendimento)=@mes

	update api.OrigemVisita set enviado = 0, finalizado = 1
	from api.CadastroIndividual f
	inner join SIGSM_Transmissao_Processos p
	on f.id = p.Id
	inner join api.UnicaLotacaoTransport h
	on f.headerTransport = h.id
	inner join api.OrigemVisita o
	on h.token = o.token
	where year(dataAtendimento)=@ano	and month(dataAtendimento)=@mes

	update api.OrigemVisita set enviado = 0, finalizado = 1
	from api.CadastroDomiciliar f
	inner join SIGSM_Transmissao_Processos p
	on f.id = p.Id
	inner join api.UnicaLotacaoTransport h
	on f.headerTransport = h.id
	inner join api.OrigemVisita o
	on h.token = o.token
	where year(dataAtendimento)=@ano	and month(dataAtendimento)=@mes

	update api.OrigemVisita set enviado = 0, finalizado = 1
	from api.FichaVisitaDomiciliarMaster f
	inner join SIGSM_Transmissao_Processos p
	on f.uuidFicha like '%' + CAST(p.Id AS VARCHAR(36))
	inner join api.UnicaLotacaoTransport h
	on f.headerTransport = h.id
	inner join api.OrigemVisita o
	on h.token = o.token
	where year(dataAtendimento)=@ano	and month(dataAtendimento)=@mes

	WHILE((SELECT TOP 1 1 FROM SIGSM_Transmissao WHERE MONTH(DataLote) = @mes AND YEAR(DataLote) = @ano) = 1)
	BEGIN
		DECLARE @idTrans UNIQUEIDENTIFIER;
		SELECT @idTrans = Id FROM SIGSM_Transmissao WHERE MONTH(DataLote) = @mes AND YEAR(DataLote) = @ano

		DELETE FROM SIGSM_ServicoSerializador_Agenda WHERE IdTransmissao = @idTrans
		DELETE L
		  FROM SIGSM_Transmissao_Processos_Log AS L
		 INNER JOIN SIGSM_Transmissao_Processos AS P ON L.IdProcesso = P.Id WHERE P.IdTransmissao = @idTrans
		DELETE FROM SIGSM_Transmissao_Processos WHERE IdTransmissao = @idTrans
		DELETE FROM SIGSM_Transmissao WHERE Id = @idTrans
	END
END
GO
PRINT N'Refreshing [api].[PR_ProcessarFichasAPI]...';


GO
EXECUTE sp_refreshsqlmodule N'[api].[PR_ProcessarFichasAPI]';


GO
PRINT N'Refreshing [dbo].[PR_INT_CadastroCredenciado]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PR_INT_CadastroCredenciado]';


GO
PRINT N'Refreshing [dbo].[ProntuarioToFichas]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[ProntuarioToFichas]';


GO
PRINT N'Refreshing [dbo].[SPF_CadastroSaude]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SPF_CadastroSaude]';


GO
PRINT N'Refreshing [dbo].[SPF_CadastroSaudeAtualiza]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SPF_CadastroSaudeAtualiza]';


GO
PRINT N'Refreshing [dbo].[SPF_CadastroSaudeAtualiza20]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SPF_CadastroSaudeAtualiza20]';


GO
PRINT N'Refreshing [dbo].[SPF_CadastroSaudeAtualizaAud]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SPF_CadastroSaudeAtualizaAud]';


GO
PRINT N'Refreshing [dbo].[SPF_GravaAtendConsultaItem]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SPF_GravaAtendConsultaItem]';


GO
PRINT N'Refreshing [dbo].[SPF_GravaAtendItemV20]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SPF_GravaAtendItemV20]';


GO
PRINT N'Refreshing [dbo].[SPF_GravaAtendAmb]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SPF_GravaAtendAmb]';


GO
PRINT N'Refreshing [dbo].[SPF_GravaAtendConsulta]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SPF_GravaAtendConsulta]';


GO
PRINT N'Refreshing [dbo].[SPF_GravaAtendSADT]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SPF_GravaAtendSADT]';


GO
PRINT N'Checking existing data against newly created constraints';


GO
USE [$(DatabaseName)];


GO
CREATE TABLE [#__checkStatus] (
    id           INT            IDENTITY (1, 1) PRIMARY KEY CLUSTERED,
    [Schema]     NVARCHAR (256),
    [Table]      NVARCHAR (256),
    [Constraint] NVARCHAR (256)
);

SET NOCOUNT ON;

DECLARE tableconstraintnames CURSOR LOCAL FORWARD_ONLY
    FOR SELECT SCHEMA_NAME([schema_id]),
               OBJECT_NAME([parent_object_id]),
               [name],
               0
        FROM   [sys].[objects]
        WHERE  [parent_object_id] IN (OBJECT_ID(N'api.Documentos'), OBJECT_ID(N'dbo.SIGSM_MicroArea_CredenciadoCidadao'), OBJECT_ID(N'dbo.SIGSM_MicroArea_CredenciadoVinc'), OBJECT_ID(N'dbo.SIGSM_MicroArea_Unidade'))
               AND [type] IN (N'F', N'C')
                   AND [object_id] IN (SELECT [object_id]
                                       FROM   [sys].[check_constraints]
                                       WHERE  [is_not_trusted] <> 0
                                              AND [is_disabled] = 0
                                       UNION
                                       SELECT [object_id]
                                       FROM   [sys].[foreign_keys]
                                       WHERE  [is_not_trusted] <> 0
                                              AND [is_disabled] = 0);

DECLARE @schemaname AS NVARCHAR (256);

DECLARE @tablename AS NVARCHAR (256);

DECLARE @checkname AS NVARCHAR (256);

DECLARE @is_not_trusted AS INT;

DECLARE @statement AS NVARCHAR (1024);

BEGIN TRY
    OPEN tableconstraintnames;
    FETCH tableconstraintnames INTO @schemaname, @tablename, @checkname, @is_not_trusted;
    WHILE @@fetch_status = 0
        BEGIN
            PRINT N'Checking constraint: ' + @checkname + N' [' + @schemaname + N'].[' + @tablename + N']';
            SET @statement = N'ALTER TABLE [' + @schemaname + N'].[' + @tablename + N'] WITH ' + CASE @is_not_trusted WHEN 0 THEN N'CHECK' ELSE N'NOCHECK' END + N' CHECK CONSTRAINT [' + @checkname + N']';
            BEGIN TRY
                EXECUTE [sp_executesql] @statement;
            END TRY
            BEGIN CATCH
                INSERT  [#__checkStatus] ([Schema], [Table], [Constraint])
                VALUES                  (@schemaname, @tablename, @checkname);
            END CATCH
            FETCH tableconstraintnames INTO @schemaname, @tablename, @checkname, @is_not_trusted;
        END
END TRY
BEGIN CATCH
    PRINT ERROR_MESSAGE();
END CATCH

IF CURSOR_STATUS(N'LOCAL', N'tableconstraintnames') >= 0
    CLOSE tableconstraintnames;

IF CURSOR_STATUS(N'LOCAL', N'tableconstraintnames') = -1
    DEALLOCATE tableconstraintnames;

SELECT N'Constraint verification failed:' + [Schema] + N'.' + [Table] + N',' + [Constraint]
FROM   [#__checkStatus];

IF @@ROWCOUNT > 0
    BEGIN
        DROP TABLE [#__checkStatus];
        RAISERROR (N'An error occurred while verifying constraints', 16, 127);
    END

SET NOCOUNT OFF;

DROP TABLE [#__checkStatus];


GO
PRINT N'Update complete.';


GO

